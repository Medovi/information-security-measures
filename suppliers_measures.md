**ИАФ.1 Идентификация и аутентификация пользователей, являющихся работниками оператора<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.1., стр. 16)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. Пользователи должны однозначно идентифицироваться и аутентифицироваться для всех видов доступа, кроме тех, которые определяются как действия, разрешённые до идентификации и авторизации (соответствующая мера: УПД.11);
2. Аутентификация пользователей должна осуществляться с использованием паролей, аппаратных средств, биометрических характеристик, иных средств или в случае многофакторной аутентификации — определённой комбинации указанных средств;
3. В ИС должна обеспечиваться возможность однозначного сопоставления идентификатора пользователя (один идентификатор — один, соответствующий ему пользователь) с запускаемыми от его имени процессами.

Доступ к различным ресурсам для сотрудников оператора осуществляется в соответствии с матрицей доступа. Матрицу доступа задаёт заказчик.

Правила и процедуры идентификации и аутентификации пользователей должны быть описаны в организационно-распорядительных документах по защите информации у заказчика.

| № | Интерфейс | Назначение | Тип интерфейса | Категории | Справка |
|---|-----------|------------|----------------|-----------|---------|
| 1. | /bin/login | Старт интерактивной сессии.<br>Запускается только в сессии без графического интерфейса. | Команда. | Локальные пользователи.<br><br>Сессия без графического интерфейса. | login(1) |
| 2. | /usr/bin/id<br>/usr/bin/groups | Отображает текущий, реальный или эффективный идентификатор и идентификатор группы, в которые входит пользователь. | Команды. | Локальные пользователи.<br><br>Сетевые ресурсы. | id(1)<br>groups(1) |
| 3. | /bin/su<br>/usr/bin/sudo | Смена пользователей и повышение привилегий. | Команды. | Локальные пользователи.<br><br>Механизмы повышения привилегий. | su(1)<br>sudo(8)<br>runas(1) |
| 4. | /etc/shadow<br>/etc/shadow-<br>/etc/tcb/[user]/shadow<br>/etc/gshadow<br>/etc/gshadow- | БД паролей и атрибутов субъектов доступа. В данном случае атрибутом аутентификационной информации являются пароли для учётных записей пользователей. | Конфигурационные файлы. | Локальные пользователи. | shadow(5) |
| 5. | getresuid()<br>getresgid()<br>getuid()<br>geteuid()<br>setuid()<br>setgid()<br>setegid()<br>setregid() | Получение или установка текущего реального или эффективного идентификатора пользователя или группы, в которой состоит пользователь. Обеспечение связывания пользователь-субъект. | Системные вызовы и библиотечные функции. | Локальные пользователи. | getresuid(2)<br>getresgid(2)<br>getuid(2)<br>geteuid(2)<br>setuid(2)<br>setgid(2)<br>setegid(2)<br>setregid(2) |
| 6. | /usr/sbin/passwd | Обеспечение проверки и манипуляций с аутентификационной информацией. | Команда. | Локальные пользователи. | passwd(1, 8) |
| 7. | /etc/pam.d/\*<br>/usr/lib64/security/pam\*.so | Реализация модулей управления типами и политиками аутентификации и файлы конфигурации этих модулей и политик. | Конфигурационные файлы и разделяемые библиотеки. | Локальные пользователи. | pam(5)<br>pam(8)<br>pam_unix(8)<br>pam_tcb(8) |
| 8. | /etc/sssd/sssd.conf<br>/etc/krb5.conf | Настройка подключения к AD/LDAP, Kerberos и GPO. Кэширование учётных данных, авторизация через GPO/LDAP/HBAC. | Конфигурационные файлы. | Доменные пользователи.<br><br>SSSD. | sssd(8)<br>kerberos(7) |
| 9. | /lib64/security/pam_sss.so<br>/lib64/security/pam_krb5.so<br>/lib64/security/pam_ldap.so | PAM-модули для аутентификации через AD/LDAP/Kerberos, интеграция с GPO. | Модули PAM. | Доменные пользователи.<br><br>SSSD. | pam_sss(8)<br>pam_krb5(5) |
| 10. | /var/lib/sss/db/cache_<домен>.ldb | Кэш авторизационных данных, GPO, тикетов Kerberos. | Внутренний кэш | Доменные пользователи.<br><br>SSSD. | sss_cache(8) |
| 11. | /etc/samba/smb.conf<br>/etc/nsswitch.conf<br>/etc/krb5.conf | Настройка Kerberos-аутентификации, сопоставления SID-UID, поддержка offline входа, GPO (через gpupdate). | Конфигурационные файлы. | Доменные пользователи.<br><br>Сетевые ресурсы.<br><br>Winbind. | smb.conf(5)<br>nsswitch.conf(5)<br>krb5.conf(5) |
| 12. | /lib64/security/pam_winbind.so<br>/usr/lib64/nss_winbind.so | PAM и NSS-интерфейсы, авторизация по SID через RPC и Kerberos/NTLM. | Модули PAM. | Доменные пользователи.<br><br>Сетевые ресурсы.<br><br>Winbind. | pam_winbind(8) |
| 13. | /var/lib/samba/\*.tdb | TDB-файлы с SID, UID/GID, SID-Map (winbindd_cache.tdb, idmap.tdb). | Внутренний кэш. | Доменные пользователи.<br><br>Сетевые ресурсы.<br><br>Winbind. | samba(7) |
| 14. | /usr/bin/gpupdate<br>/usr/sbin/gpoa<br>/lib64/security/pam_oddjob_gpupdate.so | Применение групповых политик доступа (GPO) при входе через Winbind/SSSD. | Команды.<br>Модули PAM. | Доменные пользователи.<br><br>Сетевые ресурсы.<br><br>GPO. | pam_oddjob_gpupdate(8) |
| 15. | /usr/share/lightdm/lightdm.conf.d/\*.conf<br>/etc/lightdm/lightdm.conf.d/\*.conf<br>/etc/lightdm/lightdm.conf | Настройка дисплейного менеджера LightDM. | Конфигурационные файлы. | Графическая среда (MATE). | lightdm(1) |
| 16. | /usr/sbin/control pam-pkcs11-profile<br>/usr/sbin/control pam-pkcs11-param-set<br>/usr/sbin/control pam-pkcs11-mapping | Выбор профиля железа, логики сопоставления пользователей, параметров поведения и сообщений. | Команды.<br>Контролы. | Аутентификация по смарт-картам (PKCS#11).<br><br>Двухфакторная аутентификация. | [Alt Wiki: Pkcs11-profiles](https://www.altlinux.org/Pkcs11-profiles) |
| 17. | /lib64/security/pam_pkcs11.so | PAM-модули для аутентификации по смарт-картам и токенам (PKCS#11, X.509). | Модули PAM. | Аутентификация по смарт-картам (PKCS#11).<br><br>Двухфакторная аутентификация. | pam_pkcs11(8) |
| 18. | /etc/security/pam_pkcs11<br>/etc/security/cacerts<br>/etc/security/crls<br>$HOME/.eid | Директория с конфигурацией pam_pkcs11, включая доверенные корневые сертификаты (CACerts), списки отозванных (CRL), пользовательские сертификаты. | Конфигурационные файлы. | Аутентификация по смарт-картам (PKCS#11).<br><br>Двухфакторная аутентификация. | pam_pkcs11(8)<br>[Alt Wiki: Pkcs11-profiles](https://www.altlinux.org/Pkcs11-profiles) |
| 19. | /usr/bin/pkcs11_inspect<br>/usr/bin/pklogin_finder | Анализ и проверка токенов, генерация соответствий для subject_mapping у pkcs11. | Команды. | Аутентификация по смарт-картам (PKCS#11).<br><br>Двухфакторная аутентификация. | pam_pkcs11(8) |
| 20. | /usr/sbin/control system-auth pkcs11 | Включение аутентификации по смарт-картам в PAM через pam_pkcs11. | Команда. | Аутентификация по смарт-картам (PKCS#11).<br><br>Двухфакторная аутентификация. | [Alt Wiki: двухфакторная аутентификация](https://www.altlinux.org/Двухфакторная_аутентификация) |
| 21. | /etc/security/pam_pkcs11/subject_mapping<br>/etc/security/pam_pkcs11/cn_mapping | Таблицы соответствия: какой сертификат соответствует какому пользователю. | Конфигурационные файлы. | Аутентификация по смарт-картам (PKCS#11).<br><br>Двухфакторная аутентификация. | [Alt Wiki: двухфакторная аутентификация](https://www.altlinux.org/Двухфакторная_аутентификация) |

**Краткое описание технической реализации меры ИАФ.1**

В операционной системе Альт 8 СП идентификация и аутентификация субъектов доступа реализуются с использованием механизмов локальной, доменной (на базе SSSD и Winbind), двухфакторной аутентификации а аутентификации при помощи смарт-карт.

***Общая последовательность действий при получении интерактивного сеанса***

Пользователь инициирует вход в систему через терминал или графический интерфейс.
* При инициализации входа в систему через терминал запускается программа <code>login</code>, либо соответствующая точка входа (<code>sshd</code>, <code>sudo</code>).
* При инициализации входа в систему через графический интерфейс (MATE) запускается <code>LightDM</code>.

Запускается PAM-стек, настроенный в соответствующем файле из <code>/etc/pam.d/\*</code>, в частности:
* <code>/etc/pam.d/system-auth</code> — основная системная политика;
* <code>/etc/pam.d/system-auth-sss</code>, <code>/etc/pam.d/system-auth-krb5</code>, <code>/etc/pam.d/system-auth-winbind</code> — доменные политики;
* <code>/etc/pam.d/sshd</code>, <code>/etc/pam.d/sudo</code> — политики для отдельных точек входа.

В зависимости от конфигурации, выполняются модули <code>pam_unix</code>, <code>pam_sss</code>, <code>pam_winbind</code>, <code>pam_pkcs11</code>, <code>pam_oath</code> и другие.
Вводимые пользователем данные (логин, пароль, токен и др.) передаются соответствующим модулям для сверки с БД пользователей, каталогом <code>LDAP</code>, токеном <code>PKCS#11</code> или системой <code>2FA</code>.
При успешной аутентификации происходит авторизация и предоставление интерактивного сеанса.

***Локальная идентификация и аутентификация***

Пользователь вводит имя и пароль через <code>login</code>, <code>su</code>, <code>sudo</code>, <code>sshd</code> или графический вход.
Активируется PAM-стек (<code>system-auth</code>, <code>sshd</code>, <code>sudo</code>), где основным модулем является <code>pam_unix.so</code>.
<code>pam_unix</code> вызывает функцию <code>password()</code> и сверяет введённый пароль с данными в <code>/etc/shadow</code>, <code>/etc/tcb/[user]/shadow</code>.
При успешной проверке пользователь получает сессию, которая связывается с <code>UID</code>, <code>GID</code> через системные вызовы <code>setuid()</code>, <code>getuid()</code>, <code>geteuid()</code> и т.д.
Идентификатор пользователя может быть просмотрен через <code>id</code>, <code>groups</code>, или использоваться в процессе через <code>getresuid()</code> и т.д.

***Доменная аутентификация через SSSD***

Пользователь вводит имя в формате <code>username@REALM</code> и пароль.<br>
PAM-стек использует модули <code>pam_sss.so</code>, <code>pam_krb5.so</code>, <code>pam_ldap.so</code>, указанные в <code>/etc/pam.d/system-auth-sss</code> и других соответствующих политиках.

Модуль <code>pam_sss</code> направляет запрос аутентификации в <code>sssd</code>, который:
* Получает тикет у Kerberos-сервера на основе данных из <code>/etc/krb5.conf</code>;
* Получает атрибуты пользователя из LDAP-каталога (например, AD) на основе настроек в <code>/etc/sssd/sssd.conf</code>;
* Кэширует результат в <code>/var/lib/sss/db/cache_<домен>.ldb</code>.
* При успешной проверке <code>pam_sss</code> разрешает вход.

Авторизация может быть дополнительно проверена через <code>GPO/HBAC</code> (<code>sssd-ad</code>, параметры файла <code>/etc/sssd/sssd.conf</code>: <code>ad_gpo_access_control</code>, <code>ad_gpo_map_*</code>).

***Доменная аутентификация через Winbind***

Пользователь вводит имя в формате <code>DOMAIN\username</code> или <code>username@domain</code> и пароль.<br>
<code>PAM</code> использует модуль <code>pam_winbind.so</code> и NSS-модуль <code>nss_winbind.so</code>, описанные в <code>/etc/pam.d/system-auth-winbind</code>.<br>

<code>Winbind</code> использует конфигурацию <code>/etc/samba/smb.conf</code>, <code>/etc/nsswitch.conf</code>, <code>/etc/krb5.conf</code>:
* Выполняется аутентификация через <code>Kerberos</code> (или <code>NTLM</code>, если включено);
* <code>SID-UID/GID</code> сопоставляются через <code>IDMAP</code>;
* Результаты кэшируются в <code>/var/lib/samba/\*.tdb</code>.

При наличии доступа <code>Winbind</code> возвращает положительный ответ PAM-модулю.<br>
Могут быть применены политики через <code>gpupdate</code>, <code>pam_oddjob_gpupdate.so</code>, поддерживается offline-вход.<br>

***Аутентификация по смарт-карте (PKCS#11)***

Пользователь вставляет смарт-карту в считыватель.<br>
При вызове <code>login</code> или <code>sshd</code>, PAM-стек использует модуль <code>pam_pkcs11.so</code>, активируемый через <code>control system-auth pkcs11</code>.<br>

Модуль проверяет:
* Наличие доверенных сертификатов в <code>/etc/security/cacerts</code>;
* Отсутствие отзыва (<code>CRL</code>) через <code>/etc/security/crls</code>;
* Сопоставление пользователя через <code>subject_mapping</code> или <code>cn_mapping</code> в <code>/etc/security/pam_pkcs11</code>.

Для настройки используются:
* <code>control pam-pkcs11-profile</code> — выбор аппаратного профиля;
* <code>control pam-pkcs11-param-set</code> — поведение (тихий режим, отладка);
* <code>control pam-pkcs11-mapping</code> — логика сопоставления сертификатов и пользователей.

Проверка может быть протестирована через <code>pklogin_finder</code> и <code>pkcs11_inspect</code>.<br>
При успешной проверке создаётся пользовательский сеанс.

***Двухфакторная аутентификация (2FA)***

В конфигурацию PAM (<code>/etc/pam.d/system-auth</code>, <code>sshd</code>) добавляется модуль <code>pam_oath.so</code> или <code>pam_google_authenticator.so</code>.<br>

Пользователь вводит сначала логин/пароль, затем одноразовый пароль (<code>OTP/TOTP</code>):
* <code>OTP</code> сравнивается с ключом в <code>/etc/security/pam_oath.conf</code>;
* <code>TOTP</code> — через файл <code>~/.google_authenticator</code>, созданный при инициализации.

Ввод проверяется на соответствие текущему времени или счётчику.<br>
Вход происходит только при успешной верификации всех факторов.

***Хранение и защита данных***

Все пароли хранятся в хешированном виде (<code>/etc/shadow</code>, <code>tcb</code>).<br>
Сертификаты — в <code>/etc/security/cacerts</code>, <code>CRL</code> — в <code>/etc/security/crls</code>.<br>
Конфигурации пользователей и соответствий — в <code>pam_pkcs11/subject_mapping</code>, <code>cn_mapping</code>.<br>
Ввод данных осуществляется без обратной связи.<br>
Все каналы передачи защищены (<code>TLS</code>, <code>SSH</code>).<br>
Перед вводом данных на физическом терминале выполняется принудительный сброс сессии для обеспечения доверенного маршрута.

**ИАФ.2 Идентификация и аутентификация устройств, в том числе стационарных, мобильных и портативных<br>(мера обязательна для К1 и К2)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.1., стр. 18)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. Идентификация устройств в ИС должна обеспечиваться по логическим именам (имя устройства или его ID), логическим (например, IP) или физическим (например, MAC) адресам устройства или по комбинации имени, логического и (или) физического адресов устройства;
2. Аутентификация устройств должна обеспечиваться с использованием соответствующих протоколов аутентификации или с применением в соответствии с законодательством РФ криптографических методов защиты информации.

Правила и процедуры идентификации и аутентификации устройств должны быть описаны в организационно-распорядительных документах по защите информации у заказчика.

| № | Интерфейс | Назначение | Тип интерфейса | Категории | Справка |
|---|-----------|------------|----------------|-----------|---------|
| 1. | /bin/hostname<br>/usr/bin/hostnamectl | Вывод или установка имени системы. | Команды. | Идентификаторы. | hostname(1)<br>hostnamectl(1) |
| 2. | /proc/sys/kernel/hostname | Содержит идентификацию системы в ядре ОС. | Команда. | Идентификаторы. | proc(5) |
| 3. | /etc/hosts | Содержит БД, связывающую логическое имя системы с логическим адресом узла. | Конфигурационный файл. | Идентификаторы.<br><br>Сетевые ресурсы. | hosts(5) |
| 4. | /etc/hostname<br>/etc/sysconfig/network | Содержит логическое имя узла (с доменным именем). | Конфигурационные файлы. | Идентификаторы.<br><br>Сетевые ресурсы. | hostname(1)<br>hostname(7)<br>info hostname<br>[Alt Wiki: etcnet](https://www.altlinux.org/Etcnet) |
| 5. | /sys/devices/\*<br>/sys/block/\*<br>/sys/bus/\*<br>/sys/class/\*<br>/sys/dev/\* | Содержит идентификаторы всех устройств, распознанных ОС. | Файлы структур данных ядра ОС. | Идентификаторы. | sysfs(5) |
| 6. | /etc/machine-id<br>/var/lib/dbus/machine-id | Содержит уникальный логический идентификатор установленной системы. Используется в том числе в интересах обработки и идентификации сообщения на шине D-BUS при взаимодействии между процессами и устройствами. | Конфигурационные файлы. | Идентификаторы. | dbus-uuidgen(1) |
| 7. | /sbin/systemd-machine-id-setup | Устанавливает уникальный логический идентификатор системы. | Команда. | Идентификаторы. | systemd-machine-d-setup(8) |
| 8. | /bin/uname | Сообщает информацию о ПК и ОС. | Команда. | Идентификаторы. | uname(1) |
| 9. | uname()<br>sethostname()<br>gethostname() | Сообщает имя ядра, системы, или устанавливает имя системы. | Системные вызовы и библиотечные функции. | Идентификаторы. | uname(2)<br>sethostname(2)<br>gethostname(2) |
| 10. | /etc/udev/udev.conf<br>/etc/udev/rules.d/\*<br>/usr/lib/udev/\* | Обработчик событий для устройств, работающий в интересах пользовательского пространства. | Конфигурационные файлы. | Идентификаторы.<br><br>USB-устройства. | udev(7)<br>udev.conf(5)<br>systemd-udevd(8) |
| 11. | /sbin/ip link<br>/sbin/ip addr | Получение MAC- и IP-адресов сетевых интерфейсов, настройка сетевых параметров устройства. | Команда. | Идентификаторы.<br><br>Сетевые ресурсы. | ip(8) |
| 12. | /sys/class/net/\*/address | Доступ к MAC-адресу сетевого интерфейса через sysfs. | Файл структуры данных ядра ОС. | Идентификаторы.<br><br>Сетевые ресурсы. | sysfs(5) |
| 13. | /sbin/udevadm info<br>/sbin/udevadm monitor | Просмотр атрибутов устройства, контроль событий и диагностика udev. | Команда. | Идентификаторы.<br><br>USB-устройства. | udevadm(8) |
| 14. | /sbin/blkid<br>/bin/lsblk -o UUID,SERIAL | Получение UUID, серийных номеров и меток устройств хранения. | Команды. | Идентификаторы. | blkid(8)<br>lsblk(8) |
| 15. | /etc/fstab | Привязка устройств по UUID/метке для управления монтированием. | Конфигурационный файл. | Идентификаторы. | fstab(5) |
| 16. | /etc/usbguard/rules.conf | Правила разрешения/запрета USB-устройств по серийному номеру, VID/PID, хэшу. | Конфигурационный файл. | Идентификаторы.<br><br>USB-устройства. | [Alt Wiki: USBGuard](https://www.altlinux.org/USBGuard) |
| 17. | /usr/bin/usbguard<br>/usr/sbin/usbguard-daemon | Демон и утилита для управления политиками USB-доступа. | Команда и служба. | Идентификаторы.<br><br>USB-устройства. | [Alt Wiki: USBGuard](https://www.altlinux.org/USBGuard) |
| 18. | /sbin/udevadm<br>/lib/udev/\* | Подсистема обработки событий устройств. Реагирует на появление новых устройств. | Команда и системные сценарии. | Идентификаторы.<br><br>USB-устройства. | udevadm(8) |

**Краткое описание технической реализации меры ИАФ.2**

Идентификация и аутентификация устройств, включая стационарные, мобильные и портативные, осуществляется на основе логических имён, логических (сетевых) адресов, физических идентификаторов и уникальных системных параметров, доступных в файловой системе, ядре и подсистемах Linux. Все устройства, распознанные ОС, однозначно идентифицируются как объекты доступа.

***Идентификация копии установленной ОС***

1. <b>При установке ОС оператор вручную задаёт логическое имя узла (<code>FQDN</code>) в соответствии с документацией ИС. Это имя записывается в файлы:</b>
* <code>/etc/hostname</code> — логическое имя хоста;
* <code>/etc/hosts</code> — привязка имени к IP-адресу.
2. <b>При загрузке ОС имя хоста из /etc/hostname подставляется в ядро и доступно по пути:</b>
* <code>/proc/sys/kernel/hostname</code>;
* также оно доступно через системные вызовы <code>gethostname()</code>, <code>sethostname()</code>.
3. <b>Дополнительно при установке формируется уникальный идентификатор ОС:</b>
* <code>/etc/machine-id</code> или <code>/var/lib/dbus/machine-id</code>;
* генерируется службой <code>systemd-machine-id-setup</code>;
* используется службами, D-Bus и другими компонентами для внутренней идентификации системы.

***Идентификаторы устройств и их регистрация***

1. <b>Ядро ОС отслеживает события от устройств (например, подключение USB, сетевой карты и т.д.) через системные события (прерывания), обрабатываемые подсистемой <code>udev</code>.</b>
2. <b>Подсистема <code>udev</code> (пользовательское пространство) выполняет:</b>
* регистрацию устройства;
* назначение логического имени в <code>/dev</code> (например, <code>/dev/sda</code>, <code>/dev/ttyUSB0</code>);
* назначение логического имени через правила в <code>/etc/udev/rules.d/\*.rules</code>;
* загрузку модулей ядра и установку прошивки при необходимости;
* настройку прав доступа к устройству (разграничение доступа).
3. <b>Идентификаторы устройств:</b>
* <code>/sys/devices/\*</code>, <code>/sys/class/\*</code>, <code>/sys/block/\*</code> — полные и уникальные пути в <code>sysfs</code>;
* <code>/dev/\*</code> — символьные и блочные файлы устройств;
* <code>udevadm info</code> позволяет получить уникальные атрибуты: <code>ID_SERIAL</code>, <code>ID_VENDOR</code>, <code>ID_MODEL</code> и др.

***Идентификация по физическим и сетевым параметрам***

1. <b>MAC-адрес сетевого интерфейса (например, <code>eth0</code>) считывается:</b>
* через <code>ip link</code>, <code>cat /sys/class/net/eth0/address</code>.
2. IP-адрес может быть привязан к имени хоста в <code>/etc/hosts</code>, а также через внешние механизмы (<code>DHCP</code>, <code>DNS</code>).
3. <code>UUID</code> и серийные номера устройств хранения (дисков) доступны через:
* <code>lsblk -o UUID,SERIAL</code>, <code>blkid</code>;
* используются в <code>/etc/fstab</code> для безопасного монтирования.

***Логические и комбинированные идентификаторы устройств***

Внутри системы устройства могут идентифицироваться через:
* логическое имя устройства в <code>/dev</code> (например, <code>/dev/sda1</code>);
* уникальный путь в <code>sysfs</code> (например, <code>/sys/devices/pci0000:00/0000:00:14.0/usb1</code>);
* атрибуты в <code>sysfs</code>: <code>product</code>, <code>vendor</code>, <code>serial</code>, <code>modalias</code> и др.;
* правила <code>udev</code> с логикой сопоставления и создания символьных имён (<code>SYMLINK+=</code>);
* логические имена путей в файловой системе (<code>/mnt/usb1</code>, <code>/media/token</code> и др.).

***Контроль и фильтрация устройств***

1. <b>Контроль USB-устройств может реализовываться через <code>usbguard</code>:</b>
* список разрешённых устройств: <code>/etc/usbguard/rules.conf</code>;
* демон <code>usbguard-daemon</code> отслеживает подключение и применяет правила.
2. <b>Контроль <code>MAC/IP</code> устройств:</b>
* через <code>iptables</code>, <code>nftables</code>, <code>firewalld</code> можно ограничить доступ устройств по <code>IP</code> или <code>MAC</code>;
* через <code>Match Address</code> в <code>/etc/openssh/sshd_config</code> можно разрешать доступ только с определённых устройств.

**ИАФ.3 Управление идентификаторами, в том числе создание, присвоение, уничтожение идентификаторов<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.1., стр. 19)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. Формирование идентификатора, который однозначно идентифицирует пользователя или устройство;
2. Присвоение идентификатора пользователю или устройству;
3. Предотвращение повторного использования идентификатора идентификатора или устройства в течение установленного оператором периода времени;
4. Блокирование идентификатора пользователя после установленного оператором времени неиспользования.

Правила и процедуры управления идентификаторами должны быть описаны в организационно-распорядительных документах по защите информации у заказчика.

| № | Интерфейс | Назначение | Тип интерфейса | Категории | Справка |
|---|-----------|------------|----------------|-----------|---------|
| 1. | /usr/bin/chage | Устанавливает блокировку учётной записи пользователя, после определённого времени неактивности. | Команда. | Локальные пользователи. | chage(1) |
| 2. | /etc/passwd<br>/etc/passwd-<br>/etc/group<br>/etc/group- | Содержат атрибуты учётных записей. | Конфигурационные файлы. | Локальные пользователи. | passwd(5)<br>group(5) |
| 3. | /usr/sbin/passwd | Изменяет пароль и атрибуты учётной записи. | Команда. | Локальные пользователи. | passwd(1, 8) |
| 4. | /usr/bin/chfn | Изменяет информацию о субъекте доступа. | Команда. | Локальные пользователи. | chfn(1) |
| 5. | /usr/sbin/useradd<br>/usr/sbin/usermod | Добавляет или модифицирует пользователя. | Команды. | Локальные пользователи. | useradd(8)<br>usermod(8) |
| 6. | /etc/login.defs | Задание диапазона UID и запрета на повторное использование идентификатора при помощи UID_MAX, UID_MIN, USERGROUPS_ENAB, UID_RESERVE. | Конфигурационный файл. | Локальные пользователи. | login.defs(5) |

**Краткое описание технической реализации меры ИАФ.3**

Реализация управления идентификаторами, включая их формирование, присвоение, блокировку, ограничение срока действия и предотвращение повторного использования, обеспечивается на уровне системных команд, конфигурационных файлов и логики аутентификации <code>PAM</code>.

***Формирование и присвоение идентификаторов***

Формирование уникального идентификатора осуществляется при создании учётной записи:
* через команду <code>/usr/sbin/adduser</code> или <code>/usr/sbin/useradd</code>, которая формирует запись в <code>/etc/passwd</code>, <code>/etc/shadow</code>, <code>/etc/group</code> и, при использовании <code>TCB</code>, в <code>/etc/tcb/[user]/shadow</code>;
* параметры <code>UID</code> и <code>GID</code> назначаются автоматически или задаются явно;
* для управления учётными записями в домене используются команды <code>/usr/bin/samba-tool user</code> и <code>/usr/bin/samba-tool group</code> с подкомандами.

***Модификация идентификаторов и атрибутов***

После создания идентификатор может быть изменён или дополнен через:
* команду <code>usermod</code> — изменение логина, <code>UID</code>, сроков действия;
* команду <code>passwd</code> — смена пароля и даты его смены;
* команду <code>chfn</code> — изменение поля <code>GECOS</code> (описание пользователя);
* команду <code>chage</code> — установка сроков действия, даты истечения пароля, дней до блокировки;
* при отсутствии явных сроков в атрибутах используются значения из <code>/etc/login.defs</code> — параметры <code>PASS_MAX_DAYS</code>, <code>PASS_MIN_DAYS</code>, <code>INACTIVE</code>, <code>UID_MIN</code>, <code>UID_MAX</code>, <code>UID_RESERVE</code>, и др.

***Блокировка и срок действия идентификаторов***

Параметры, определяющие время действия идентификатора:
* <code>chage -E <YYYY-MM-DD></code> — устанавливает дату блокировки учётной записи;
* <code>chage -I N</code> — блокирует учётную запись после <code>N</code> дней неиспользования;
* <code>passwd -l</code> — вручную блокирует пароль пользователя (и вход);
* <code>/etc/shadow</code> — поле с датой истечения срока действия пароля.
При попытке входа в систему <code>PAM</code> проверяет сроки действия через модули <code>pam_unix</code> или <code>pam_sss</code>, и, если они истекли или учётная запись заблокирована, вход отклоняется.

***Предотвращение повторного использования идентификатора***

По умолчанию ОС не ограничивает повторное использование логина или <code>UID</code>. Для выполнения этого требования применяются организационные меры:
1. Поддержка архива удалённых логинов/<code>UID</code>:
* ведение файла <code>/etc/security/uid_archive</code> со списком логинов, которые нельзя использовать повторно;
2. Обёртка над <code>useradd</code>, проверяющая наличие логина в архиве перед созданием;
3. Конфигурация <code>/etc/login.defs</code> с зарезервированными <code>UID</code> (через <code>UID_MIN</code>, <code>UID_MAX</code>, <code>UID_RESERVE</code>) и пользовательскими группами (<code>USERGROUPS_ENAB</code>);
4. При использовании <code>FreeIPA</code> или <code>LDAP</code> возможна централизованная проверка и запрет переиспользования логинов.

**ИАФ.4 Управление средствами аутентификации, в том числе хранение, выдача, инициализация, блокирование средств аутентификации и принятие мер в случае утраты и (или) компрометации средств аутентификации<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.1., стр. 20)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. Возможность хранения, выдачи, инициализации, блокирования средств аутентификации;
2. Возможность изменения аутентификационной информации (средств аутентификации), заданных их производителями или используемых при внедрении системы защиты информации ИС;
3. Генерация начальной аутентификационной информации;
4. Возможность установления характеристик пароля (при использовании в ИС механизмов аутентификации на основе пароля):
* задане минимальной сложности пароля с определяемыми оператором требованиям к регистру, количеству символов, сочетанию букв верхнего и нижнего регистра, цифр и специальных символов;
* задание минимального количества изменённых символов при создании новых паролей;
* задание максимального времени действия пароля;
* задание минимального времени действия пароля;
* запрет на использование пользователями определённого оператором числа последних использованных паролей при создании новых паролей;
5. Возможность блокирования и замены утерянных, скомпрометированных или повреждённых средств аутентификации;
6. Назначение необходимых характеристик средств аутентификации (в т.ч. паролей);
7. Возможность обновления аутентификационной информации (замена средств аутентификации) с периодичностью, установленной оператором;
8. Защита аутентификационной информации от неправомерного доступа к ней и модифицирования.

Правила и процедуры управления средствами аутентификации должны быть описаны в организационно-распорядительных документах по защите информации у заказчика.

| № | Интерфейс | Назначение | Тип интерфейса | Категории | Справка |
|---|-----------|------------|----------------|-----------|---------|
| 1. | /etc/pam.d/system-auth-local-only<br>/etc/pam.d/system-auth-common | Устанавливает необходимость применения парольной политики. | Конфигурационные файлы. | Локальные пользователи. | pam(8) |
| 2. | /usr/lib64/security/* | Реализация политик аутентификации. | Разделяемые библиотеки | Локальные пользователи. | pam(8)<br>pam_u2f(8) |
| 3. | /etc/passwdqc.conf<br>/etc/security/pwquality.conf | Устанавливает строгость парольных политик. | Конфигурационные файлы | Локальные пользователи. | passwdqc.conf(5)<br>[Настройка парольных ограничений](https://docs.altlinux.org/ru-RU/alt-server/10.2/html/alt-server/passwdqc.html)<br>pwquality.conf(5) |
| 4. | /usr/bin/samba-tool domain passwordsettings pso | Позволяет применить парольную политику к пользователям или группам пользователей. | Команда. |  | samba-tool(8) |
| 5. | /usr/bin/passwd | Установка/Изменение пароля. | Команда. | Локальные пользователи. | passwd(1, 8) |
| 6. | /usr/sbin/useradd<br>/usr/sbin/usermod | Создание пользователя, генерация начального пароля, блокировка, сброс и изменение параметров учётной записи пользователя. | Команды. | Локальные пользователи. | useradd(8)<br>usermod(8) |
| 7. | /usr/bin/chage | Установка сроков действия пароля, принудительная смена. | Команда. | Локальные пользователи. | chage(1) |
| 8. | /etc/login.defs | Значения по умолчанию для сроков действия и блокировки паролей. | Конфигурационный файл. | Локальные пользователи. | login.defs(5) |
| 9. | /etc/shadow<br>/etc/shadow-<br>/etc/tcb/[user]/shadow<br>/etc/gshadow<br>/etc/gshadow- | Защищённые хранилища хэшей паролей. | Системные файлы. | Локальные пользователи. | shadow(5) |
| 10. | /usr/lib64/security/pam_pwhistory.so | Позволяет настроить запрет повторного использования старых паролей. | Модуль PAM. | Локальные пользователи. | pam_pwhistory(8) |
| 11. | /etc/security/pwquality.conf | Позволяет настроить сложность пароля для локальных УЗ. | Конфигурационный файл | Локальные пользователи. | pwquality.conf(5) |
| 12. | /usr/bin/samba-tool domain passwordsettings set | Позволяет настроить сложность пароля для доменных УЗ. | Команда. | Доменные пользователи | samba-tool(8) |

**ИАФ.5 Защита обратной связи при вводе аутентификационной информации<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.1., стр. 22)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. Защита обратной связи в процессе аутентификации обеспечивается исключением отображения для пользователя действительного значения аутентификационной информации или количества вводимых пользователем символов аутентификационной информации. Вводимые символы пароля могут отображаться в виде условных знаков, например, знаком звёздочки "*", точки "·" и т.д.

Обычно защита обратной связи в процессе аутентификации обеспечивается в любой системе по умолчанию. 

**ИАФ.6 Идентификация и аутентификация пользователей, не являющихся работниками оператора (внешних пользователей)<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.1., стр. 23)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. Пользователи должны однозначно идентифицироваться и аутентифицироваться для всех видов доступа, кроме тех, которые определяются как действия, разрешённые до идентификации и авторизации (соответствующая мера: УПД.11);

Правила и процедуры идентификации и аутентификации должны быть описаны в организационно-распорядительных документах по защите информации у заказчика.

Мера аналогична мере ИАФ.1, за исключением того, что к внешним пользователям относят всех пользователей ИС, не указанных в ИАФ.1 в качестве внутренних пользователей.<br>
Пример внутренних пользователей: сотрудники оператора; лица, привлекаемые на договорной основе (ремонт, обслуживание ИС).<br>
Пример внешний пользователей: граждание, получаемые доступ к ИС на законных основаниях.<br>
Если в системе предусмотрена идентификация и аутентификация внешних пользователей с целью получения каких-либо государственных услуг, то идентификация и аутентификация должна происходить в соответствии с [постановлением Правительства РФ № 977 от 28.11.2011](https://www.consultant.ru/document/cons_doc_LAW_122455/).

Интерфейсы аналогичны тем, что указаны в мере ИАФ.1.

**ИАФ.7 Идентификация и аутентификация объектов файловой системы, запускаемых и исполняемых модулей, объектов систем управления базами данных, объектов, создаваемых прикладным и специальным программным обеспечением, иных объектов доступа<br>(мера является не обязательной для всех классов защищённости)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.1., стр. 24)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. В ИС должна осуществляться идентификация и атуентификация объектов файловой системы, запускаемых и исполняемых модулей, объектов систем управления базами данных, объектов, создаваемых прикладным и специальным программным обеспечением, иных объектов доступа.

Реализация меры становится обязательной, когда у заказчика она появляется в итоговом списке мер безопасности информации.

**УПД.1 Управление (заведение, активация, блокирование и уничтожение) учетными записями пользователей, в том числе внешних пользователей<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.2., стр. 25)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. Определение типа учётной записи (внутреннего или внешнего пользователя, системная или приложения и т.д.);
2. Возможность определения учётных записей в группы;
3. Верификация пользователя при заведении учётной записи пользователя;
4. Возможность заведения, активации, блокирования и уничтожения учётных записей пользователей;
5. Оповещение администратора, осуществляющего управление учётными записями пользователей, об изменении сведений о пользователях, их ролях, обязанностях, полномочиях, ограничениях;
6. Возможность уничтожения временной учётных записей пользователей, предоставленных для однократного выполнения задач в ИС;
7. Возможность предоставления пользователям прав доступа к объектам доступа ИС, основываясь на задачах, решаемых пользователями в ИС и взаимодействующими с ней ИС.

Правила и процедуры управления учётными записями пользователей должны быть описаны в организационно-распорядительных документах по защите информации у заказчика.

Мера аналогична мере ИАФ.3.

В ОС Альт 8 СП управление учётными записями и группами пользователей может происходить централизовано для домена на контроллере домена при помощи <code>/usr/bin/samba-tool user</code> и <code>/usr/bin/samba-tool group</code>.

**УПД.2 Реализация необходимых методов (дискреционный, мандатный, ролевой или иной метод), типов (чтение, запись, выполнение или иной тип) и правил разграничения доступа<br>(мера обязательна для К1, К2 и К3)**

Методы управления доступом определяются заказчиком и включают один или комбинацию следующих методов:
* Дискреционный метод управления доступом, предусматривающий управление доступом субъектов доступа (пользователей) к объектам доступа (ресурсам ИС) на основе идентификационной информации (например, паролей) субъекта и для каждого объекта доступа – списка, содержащего группы субъектов доступа и ассоциированные с ними типы доступа;
* Ролевой метод управления доступом, предусматривающий управление доступом субъектов доступа к объектам доступа на основе ролей субъектов доступа (совокупность действий и обязанностей, связанных с определённым видом деятельности);
* Мандатный метод управления доступом, предусматривающий управление доступом субъектов доступа к объектам доступа на основе классификационных меток каждого субъекта доступа и каждого объекта доступа, отражающих классификационные уровни субъектов доступа и объектов доступа, являющиеся комбинациями иерархических и неиерархических категорий.

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.2., стр. 26)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. В ИС должен быть реализован один из методов управления доступом, описанных ранее;
2. Типы доступа должны включать операции по чтению, записи, удалению и иные операции, разрешённые к выполнению пользователям (или группе пользователей) или запускаемому от его имени процессу при доступе к объектам доступа (типы доступа определяет заказчик).

Правила разграничения доступа должны быть описаны в организационно-распорядительных документах по защите информации у заказчика.

| № | Интерфейс | Назначение | Тип интерфейса | Категории | Справка |
|---|-----------|------------|----------------|-----------|---------|
| 1. | /usr/bin/ls<br>/usr/bin/chmod<br>/usr/bin/chown<br>/usr/bin/chgrp<br>umask | Отображает или назначает права доступа POSIX (в т.ч. с помощью маски прав, используемой по умолчанию). | Команды. | Разграничение доступа. | ls(1)<br>chmod(1)<br>chown(1)<br>chgrp(1)<br>umask(1) |
| 2. | /usr/bin/getfacl<br>/usr/bin/setfacl | Отображает или формирует списки контроля доступа (ACL) POSIX.1e (в т.ч. с помощью маски прав, используемой по умолчанию). | Команды. | Разграничение доступа. | getfacl(1)<br>setfacl(1)<br>acl(5) |
| 3. | /sbin/getcap<br>/sbin/setcap | Отображает или формирует мандаты разрешений (capabilities). | Команды. | Разграничение доступа. | capabilities(7)<br>prctl(2) |
| 4. | access()<br>chmod()<br>chown()<br>prctl()<br>umask() | Интерфейсы с функциями монитора обращений ядра ОС. | Интерфейсы ядра (системные вызовы). | Разграничение доступа. | access(2)<br>chmod(2)<br>chown(2)<br>prctl(2)<br>umask(2) |
| 5. | /usr/bin/samba-tool | Позволяет управлять пользователями, группами, правами и политиками безопасности AD через CLI. | Команда. | Разграничение доступа.<br><br>Доменные пользователи. | samba-tool(8) |
| 6. | /usr/bin/wbinfo | Позволяет получать SID, UID, GID и проверять привязку к AD (через winbind). | Команда. | Разграничение доступа. | wbinfo(1) |
| 7. | /usr/bin/getent | Позволяет получать информацию о пользователях и группах из домена через NSS. | Команда. | Разграничение доступа. | getent(1) |
| 8. | /usr/bin/setfacl<br>/usr/bin/getfacl | Позволяет назначить расширенные права доступа (ACL) доменным субъектам. | Команды. | Разграничение доступа. | setfaclt(1)<br>getfacl(1) |
| 9. | /usr/bin/net | Позволяет настраивать, диагностировать и управлять подключением к AD (через winbind). | Команда. | Разграничение доступа.<br><br>Доменные пользователи.<br><br>Сетевые ресурсы. | net(8) |
| 10. | /etc/samba/smb.conf | Основной конфигурационный файл Samba (пределяет домен и соответствующие настройки). | Конфигурационный файл. |  Разграничение доступа.<br><br>Доменные пользователи. | smb.conf(5) |
| 11. | /etc/krb5.conf | Настройка kerberos (realm, серверы). | Конфигурационный файл. |  Разграничение доступа.<br><br>Доменные пользователи. | krb5.conf(5) |
| 12. | /etc/nsswitch.conf | Подключение к системным источникам пользователей/групп (passwd, group, shadow). | Конфигурационный файл. |  Разграничение доступа.<br><br>Доменные пользователи.<br><br>Сетевые ресурсы. | nsswitch.conf(5) |
| 13. | /etc/sssd/sssd.conf | Конфигурация демона SSSD для получения данных из AD через LDAP/Kerberos. | Конфигурационный файл. | Разграничение доступа.<br><br>Доменные пользователи.<br><br>Сетевые ресурсы. | sssd.conf(5) |
| 14. | /etc/security/pam_winbind.conf | Параметры для PAM-модуля pam_winbind.so (если используется winbind). | Конфигурационный файл. | Разграничение доступа.<br><br>Доменные пользователи.<br><br>Сетевые ресурсы. | pam_winbind.conf(5) |
| 15. | /lib64/security/pam_winbind.so<br>/lib64/security/pam_sss.so | PAM-модули для аутентификации доменных пользователей. | Разделяемые библиотеки. | Разграничение доступа.<br><br>Доменные пользователи.<br><br>Сетевые ресурсы. | pam_winbind(8)<br>pam_sss(8) |
| 16. | /usr/bin/chmod<br>/usr/bin/chown<br>/usr/bin/ls<br>umask | Назначение и просмотр POSIX-прав (в т.ч. доменным субъектам). | Команды. | Разграничение доступа. | chmod(1)<br>chown(1)<br>ls(1)<br>umask(1) |
| 17. | /sbin/setcap<br>/sbin/getcap | Назначение и просмотр capabilities. | Команды. | Разграничение доступа. | setcap(8)<br>getcap(8) |

***Общее описание***

Во всех ОС Linux изначально реализован дискретный метод управления доступом (Discretionary Access Control, DAC). Дискреционный контроль доступа применяется каждый раз, при попытке обращения субъекта к объекту. Обе сущности, и субъект и объект содержат атрибуты безопасности, которые принадлежат дискреционной модели.
Ядро ОС проверяет уровень досутпа, базирующийся на данных атрибутах с одной стороны, и правилах разграничения доступа с другой стороны. Дискреционная модель ползволяет владельцу объекта определить кто обладает полномочиями осуществлять доступ к объекту.<br>
Субъектами в реализации дискреционной модели доступа выступают процессы ОС.
Процессы представленны программной структурой ядра <code>task_struct</code> (<code>/proc/<PID>task</code>).
Все перечисленные сущности, такие как: обычные файлы, файлы устройств (блочные и символьные), директории и файлы сокетов (или пайпов) – всё это с точки зрения дискретной модели разграничения доступа ядра ОС являются объектами доступа и попадают под действие политик дискреционной модели разграничения доступа.

***Стандартные права POSIX***

Основные биты прав доступа <code>POSIX</code>:
* Бит чтения (двоичное <code>100</code>, десятичное <code>4</code>, символьное <code>r</code>) позволяет читать содержимое объекта (информационный поток направляется от объекта к субъекту);
* Бит записи (двоичное <code>010</code>, десятичное <code>2</code>, символьное <code>w</code>) позволяет записывать содержимое объекта доступа (информационный поток направляется от субъекта к объекту);
* Бит выполнения (двоичное <code>001</code>, десятичное <code>1</code>, символьное <code>x</code>) позволяет выполнить содержимое объекта (информационный поток направлен от объекта к субъекту и в страницы виртуальной памяти для помещения в очередь на выполнение процессором).

Таблица с правами <code>POSIX</code>:
| Десятичная<br>запись | Двоичная<br>запись | Маска | Права на файл | Права на каталог |
|----------------------|--------------------|-------|------------------|---------------------|
| 0 | 000 | --- | Права отсутствуют | Права отсутствуют |
| 1 | 001 | --x | Право на выполнение | Право на доступ к объектам и их метаданным |
| 2 | 010 | -w- | Право на запись | Права отсутствуют |
| 3 | 011 | -wx | Права на запись и выполнение | Все права кроме доступа к именам объектов |
| 4 | 100 | r-- | Право на чтение | Только чтение имён файлов |
| 5 | 101 | r-x | Права на чтение и выполнение | Права на чтение имён объектов и доступ к объектам и их атрибутам |
| 6 | 110 | rw- | Права на чтение и запись | Только чтение имён файлов |
| 7 | 111 | rwx | Полные права | Полные права |

Существуют также специальные биты разрешений:
* Бит смены идентификатора пользователя (<code>SUID</code>-bit, двоичное <code>111110100000</code>, десятичное <code>04000</code>, символьное "<code>s</code>") позволяет на время выполнения программы (или процесса) изменять его владельца;
* Бит смены идентификатора группы (<code>SGID</code>-bit, двоичное <code>111111010000</code>, десятичное <code>02000</code>, символьное "<code>g</code>") позволяет на время выполнения (или процесса) изменять его основную группу;
* Sticky-bit (двоичное <code>1111101000</code>, десятичное <code>01000</code>, символьное "<code>t</code>") существует только для каталогов и позволяет производить удаление только владельцу объекта, даже если биты прав доступа допускают иное..

В качестве расширения дискреционной модели ОС могут выступать:
* Списки контроля доступа <code>POSIX</code> (<code>Access Control List</code>, <code>ACL</code>), являющиеся реализацией спецификации <code>POSIX.1e</code>;
* "Возможности", "Мандаты" или "Capabilities", позволяющие атомарно разрешать тот или иной набор операций. На данный момент для ядра 6.1 определено 40 операций, заданных в <code>/usr/include/linux/capability.h</code>;
* Атрибуты объектов ("только для чтения", "архивный", "неизменный" и другие), также определённые спецификацией <code>POSIX.1e</code>.

**УПД.3 Управление (фильтрация, маршрутизация, контроль соединений, однонаправленная передача и иные способы управления) информационными потоками между устройствами, сегментами информационной системы, а также между информационными системами<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.2., стр. 29)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:

В ИС должно обеспечиваться следующее:
1. фильтрация информационных потоков;
2. разрешение передачи информации в ИС только по установленному оператором маршруту;
3. возможность изменения маршрута передачи информации;
4. возможность записи во временное хранилище информации для анализа и принятия решения о возможности её дальнейшей передачи.
Управление информационными потоками должно блокировать передачи защищаемой информации через сеть Интернет по незащищённым линиям связи, сетевые запросы и трафик, несанкционированно исходящие из ИС и (или) входящие в ИС.

Правила и процедуры управления идентификационными потоками должны быть описаны в организационно-распорядительных документах по защите информации у заказчика.

| № | Интерфейс | Назначение | Тип интерфейса | Категории | Справка |
|---|-----------|------------|----------------|-----------|---------|
| 1. | /sbin/iptables<br>/usr/sbin/nft | Утилита настройки фильтрации и маршрутизации сетевых пакетов (nft является заменой ifconfig). | Команда | Сетевые ресурсы. | iptables(8) |
| 2. | /sbin/ip | Утилита для управления маршрутами, интерфейсами и правилами маршрутизации. | Команда. | Сетевые ресурсы. | ip(8) |
| 3. | /usr/bin/tcpdump | Анализатор сетевого трафика (или сниффер), позволяет сохранять сетевые пакеты для анализа. | Команда. | Сетевые ресурсы. | tcpdump(8) |
| 4. | /usr/sbin/snort<br>/etc/snort/* | Система обнаружения и предотвращения вторжений (IDS/IPS). | Команда и конфигурационные файлы программы. | Сетевые ресурсы. | snort(8) |
| 5. | /usr/bin/suricata<br>/etc/suricata | Система обнаружения и предотвращения вторжений (IDS/IPS). | Команда и конфигурационные файлы программы. | Сетевые ресурсы. | suricata(8) |
| 6. | /etc/hosts.allow<br>/etc/hosts.deny | Файлы управления доступом/запретом для TCP-соединений. | Конфигурационные файлы. | Сетевые ресурсы. | hosts(5) |

Мера реализуется в основном за счёт применения межсетевых экранов и систем обнаружения и предотвращения вторжений.

Согласно [Методическому документу ФСТЭК "Профили защиты межсетевых экранов" от 12.09.2016](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-12-sentyabrya-2016-g), существует 5 типов межсетевых экранов:
1. <b>Тип "А" (межсетевой экран уровня сети)</b> — программно-аппаратное решение, устанавливаемое на периметре защищаемой информационной системы или между физическими границами её сегментов.
2. <b>Тип "Б" (межсетевой экран уровня логических границ сети)</b> — программное или программно-аппаратное решение, устанавливаемое на логическом периметре защищаемой информационной системы или между логическими границами её сегментов.
3. <b>Тип "В" (межсетевой экран уровня узла)</b> — программный межсетевой экран, устанавливаемый на хосте (мобильном или стационарном) информационной системы.
4. <b>Тип "Г" (межсетевой экран уровня веб-сервера)</b> — межсетевой экран программного или программно-аппаратного исполнения, устанавливаемый на веб-сервер или на периметре сегмента таких серверов и обеспечивающий контроль и фильтрацию HTTP-трафика.
5. <b>Тип "Д" (межсетевой экран уровня промышленной сети)</b> — межсетевой экран программного или программно-аппаратного исполнения, устанавливаемый в АСУ ТП и обеспечивающий контроль и фильтрацию промышленных протоколов передачи данных.

Межсетевые экраны <code>iptables</code> и <code>nftables</code> относятся к межсетевым экранам уровня узла (тип "В").

Фильтрацию пакетов может выполнять межсетевой экран <code>iptables</code>.

<code>Iptables</code> — утилита для настройки правил фильтрации сетевых пакетов. Она работает с таблицами (<code>filter</code>, <code>mangle</code>, <code>row</code>, <code>nat</code>, <code>security</code>), цепочками (<code>PREROUTING</code>, <code>INPUT</code>, <code>FORWARD</code>, <code>OUTPUT</code>, <code>POSTROUTING</code>) и правилами (<code>ACCEPT</code>, <code>DROP</code>, <code>LOG</code>, <code>RETURN</code>, <code>REDIRECT</code>, <code>DNAT</code>, <code>SNAT</code>, <code>TTL</code>), которые определяют как обрабатывать сетевые пакеты. Чуть подробнее про межсетевой экран <code>Iptables</code> можно прочитать на соответствующей странице [Alt Wiki: Firewall start](https://www.altlinux.org/Firewall_start)

Система обнаружения вторжений (<code>Intrusion Detection System</code>, <code>IDS</code>) выполняет мониторинг сетевого трафика и анализ событий с целью выявления потенциальных атак или подозрительной активности. Система не блокирует угрозы, а только сообщает о них администратору безопасности.

Система предотвращения вторжений (<code>Intrusion Prevention System</code>, <code>IPS</code>) выявляет угрозы безопасности и принимает автоматические меры по их нейтрализации, блокирует вредоносные действия, предотвращая возможные атаки в реальном времени. Системы работают на уровне сети и анализируют трафик для блокировки подозрительной активности до того, как она нанесёт вред ИС.

<code>Snort</code> и <code>Suricata</code> являются системами обнаружения и предотвращения вторжений (<code>IDS/IPS</code>) и их можно настроить соответствующим образом в зависисмости от потребностей ИС (т.е. если в ИС есть потребность использовать только систему обнаружения вторжений, можно любое из этих средств настроить так, чтобы система сама не неагировала на вторжения, а все уведомления безопасности поступали сразу к администратору безопасности).

Для реагирования на события безопасности строятся правила (сигнатуры) в конфигурационных файлах системы обнаружения/предотвращения вторжения. Для <code>Snort</code> — это конфигурационные файлы в папке <code>/etc/snort/rules</code>. Также для добавления новых файлов с правилами можно настроить конфигурационный файл <code>/etc/snort/snort.conf</code>. У <code>Suricata</code> файл с сигнатурами находится по пути <code>/etc/suricata/rules</code>. Для работы <code>IPS</code>-режима у <code>Suricata</code> требуется дополнительаня настройка брандмауэра, например, <code>iptables</code>.

Все настройки, связанные с межсетевым экранированием и системами обнаружения и предотвращения вторжений должны выполняться в соответствии с требованиями оператора.

**УПД.4 Разделение полномочий (ролей) пользователей, администраторов и лиц, обеспечивающих функционирование информационной системы<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.2., стр. 30)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) оператором должно быть обеспечено разделение полномочий (или ролей) пользователей ИС в соответствии с их должностными обязанностями, где это фиксируется в соответствующих организационно-распорядительных документах. Доступ к объектам доступа с учёто разделения полномочий обеспечивается в соответствии с мерой УПД.2.

Интерфейсы данной меры соответствуют интерфейсам меры УПД.2.

Мера по большей части организационная, т.к. разделение полномочий производится оператором и фиксируется в организационно-распорядительной документации. В задачи технической реализации входит назначение определённым должностным лицам соответствующих прав.

**УПД.5 Назначение минимально необходимых прав и привилегий пользователям, администраторам и лицам, обеспечивающим функционирование информационной системы<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.2., стр. 31)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) оператором должно быть обеспечено назначение прав и привилегий пользователям ИС и запускаемым от их имени процессам минимально необходимых для выполнения своих должностных обязанностей, и санкционирование доступа к объектам доступа в соответствии с минимально необходимыми правами и привилегиями. Перечень таких прав и привилегий оператор фиксирует в соответствующей организационно-распорядительной документации.

Интерфейсы данной меры соответствуют интерфейсам меры УПД.2.

**УПД.6 Ограничение неуспешных попыток входа в информационную систему (доступа к информационной системе)<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.2., стр. 32)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) оператором устанавливается и фиксируется в соответствующей организационно-распорядительной документации ограничение неуспешных попыток входа в ИС за определённый оператором период времени, а также обеспечение блокирования устройства, с которого предпринимаются попытки доступа или учётной записи пользователя при превышении ограничения количества неуспешных попыток входа в ИС.

Ограничение количества неуспешных попыток входа в информационную систему обеспечивается в соответствии с мерой ИАФ.4.

| № | Интерфейс | Назначение | Тип интерфейса | Категории | Справка |
|---|-----------|------------|----------------|-----------|---------|
| 1. | /etc/pam.d/*<br>/etc/security/faillock.conf | Интерфейс создания и проверки пароля по алгоритму ГОСТ Р 34.11-2012. | Конфигурационные файлы. |  | faillock(8)<br>pam_faillock(8)<br>[Задание хешей паролей в соответствии с ГОСТ 34.11-2012](https://docs.altlinux.org/ru-RU/alt-workstation/10.4/html/alt-workstation/hash_pass.html) |
| 2. | /usr/bin/samba-tool domain passwordsettings pso | Позволяет применить парольную политику к пользователям или группам пользователей.<br>Позволяет настроить блокирование доступа при первышении числа неудачных попыток входа в ИС. | Команда. |  | samba-tool(8)<br>[Управление парольными политиками при помощи samba-tool](https://docs.altlinux.org/ru-RU/domain/10.4/html/alt-domain/ch40s02s02.html)<br>[Управление объектами парольных настроек](https://docs.altlinux.org/ru-RU/domain/10.4/html/group-policy/pso.html) |

Администратор системы может используя возможности <code>PAM</code>-модуля <code>faillock</code> устанавливать политики ограничений неуспешных попыток доступа. Политики применяются немедленно после модификации конфигурации <code>PAM</code>-модуля. Отдельно для доменных пользователей возможна реализация меры при помощи групповых политик.

**УПД.7 Предупреждение пользователя при его входе в информационную систему о том, что в информационной системе реализованы меры защиты информации, и о необходимости соблюдения им установленных оператором правил обработки информации<br>(мера является не обязательной для всех классов защищённости)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.2., стр. 33)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. Должно быть обеспечено предупреждение пользователя в виде сообщения (или "окна") при его входе в систему (по процесса аутентификации) о том, что в ИС реализованы меры защиты информации, а так же о том, что в ИС пользователем должны соблюдаться установленные оператором правила и ограничения на работу с информацией;
2. Вход в ИС и предоставление пользователю возможности работы в ИС должы осуществляться только после подтверждения пользователем ознакомления с преупреждением.

Возможно, для технической реализации этой меры необходимо продумать механизм, способный отображать окно (если в графике) с уведомлением о том, что в системе реализованы меры защиты информации и о том, что пользователем должны соблюдаться правила обработки информации, установленные оператором.

Мера является не обязательной, но заказчик может включить её в итоговый набор мер.

**УПД.8 Оповещение пользователя после успешного входа в информационную систему о его предыдущем входе в информационную систему<br>(мера является не обязательной для всех классов защищённости)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.2., стр. 34)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. В ИС для пользователя, завершившего процесс аутентификации, должно быть обеспечено оповещение о дате и времени предыдущего входа в систему от имени этого пользователя.

Возможно, для технической реализации этой меры необходимо продумать механизм, способный отображать окно (если в графике) с уведомлением после завершения пользователем процесса аутентификации о дате и времени его предыдущего входа в систему.<br>
Возможно также, в графической среде (KDE, GNOME, MATE) механизм уже реализован. Механизм можно реализовать, используя сценарий запуска <code>~/xsession</code> или <code>~/bash_profile</code> и <code>zenity</code>.

Скрипт для уведомления может выглядеть так:
```bash
#!/bin/bash

last_login="$(last -n 2 $USER | tail -n 1)"
zenity --info --text "Предыдущий вход: $last_login"
```

Мера является не обязательной, но заказчик может включить её в итоговый набор мер.

**УПД.9 Ограничение числа параллельных сеансов доступа для каждой учетной записи пользователя информационной системы<br>(мера обязательна для К1)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.2., стр. 35)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. В ИС должна быть предусмотрена возможность задавать ограничения на число параллельных (или одновременных) сеансов, основываясь на идентификаторах или ролях (в случае, если используется ролевая матрица доступа);
2. Значение числа параллельных сеансов доступа может быть задано для ИС в целом, отдельных сегментов ИС, групп пользователей, отдельных пользователей или комбинаций перечисленного.

Ограничение числа параллельных сеансов доступа должно быть описано в организационно-распорядительных документах по защите информации у заказчика.

| № | Интерфейс | Назначение | Тип интерфейса | Категории | Справка |
|---|-----------|------------|----------------|-----------|---------|
| 1. | /etc/security/limits.conf | Определение ограничений ресурсов системы для пользователя или групп пользователей. | Конфигурационный файл. | Локальные пользователи. | limits.conf(5) |
| 2. | /lib64/security/pam_limits.so | Модуль PAM для определения ограничений ресурсов системы. | Модуль PAM. | Локальные пользователи. | pam_limits(8) |

В файле <code>/etc/security/limits.conf</code> задаются пользователи или группы пользователей в формате
```
<domain> <type> <item> <value>
```

Поле <code>\<domain\></code> может содержать следующую информацию:
* Имя пользователя.
* Имя группы. Перед именем группы указывается символ <code>@</code>.
* Символ <code>*</code>. Данное ограничение будет являться ограничением по умолчанию.
* Символ <code>%</code>. Используется только с ограничением <code>maxlogins</code>. Группа, указанная после <code>%</code>, ограничивает число параллельных процессов для каждого пользователя, находящегося в указанной группе. Если символ <code>%</code> используется отдельно, то он идентичен использованию символа <code>*</code> с ограничением <code>massyslogins</code>.
* Диапазон <code>uid</code>, заданный как <code><min_uid>:<max_uid></code>.
* Диапазон <code>gid</code>, заданный как <code>@<min_gid>:<max_gid></code>.
* <code>gid</code>, заданный как <code>%:\<gid\></code>

Поле <code>\<type\></code> является типом ограничения: мягкое (<code>soft</code>) или жёсткое (<code>hard</code>). Мягкое ограничение определяет число системных ресурсов, которое пользователь всё ещё может превысить, жёсткое ограничение превысить нельзя (тогда пользователь увидит сообщение об ошибке). Символ <code>-</code> используется для одновременной установки мягкого и жёсткого ограничения.

Поле <code>\<item\></code> является элементом ограничения и может быть одним из следующих значений:
* <code>core</code> – ограничение размера файла <code>core</code> (Кбайт);
* <code>data</code> – максимальный размер данных (Кбайт);
* <code>fsize</code> – максимальный размер файла (Кбайт);
* <code>memlock</code> – максимальное заблокированное адресное пространство (Кбайт);
* <code>nofile</code> – максимальное число открытых файлов;
* <code>stack</code> – максимальный размер стека (Кбайт);
* <code>cpu</code> – максимальное время процессора (минуты);
* <code>nproc</code> – максимальное число процессов;
* <code>as</code> – ограничение адресного пространства;
* <code>maxlogins</code> – максимальное число одновременных регистраций в системе;
* <code>maxsyslogins</code> – максимальное количество учётных записей;
* <code>priority</code> – приоритет запуска пользовательских процессов;
* <code>locks</code> – максимальное число файлов блокировки;
* <code>sigpending</code> – максимальное количество сигналов, которые можно передать процессу;
* <code>msgqueue</code> – максимальный размер памяти для очереди <code>POSIX</code> сообщений (байт);
* <code>nice</code> – максимальный приоритет, который можно выставить: [-20, 19];
* <code>rtprio</code> – максимальный приоритет времени выполнения.

Поле <code>\<value\></code> необходимо для задания числа ресурсов.

Для ограничения числа параллельных сеансов доступа для учётной записи каждого пользователя:
```
* - maxlogins 5
```
Ограничение числа параллельных сеансов доступа также можно настроить в ЦУС (раздел "Система → "Настройки ограничений"). Для этого необходим пакет <code>alterator-limits</code>.

**УПД.10 Блокирование сеанса доступа в информационную систему после установленного времени бездействия (неактивности) пользователя или по его запросу<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.2., стр. 36)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) в ИС должно обеспечиваться блокирование сеанса доступа пользователя после установленного оператором времени его бездействия (или неактивности) в ИС или по запросу пользователя.

Блокирование сеанса доступа пользователя должно обеспечивать врмененную приостановку работы пользователя со средством вычислительной техники, с которого осуществляется доступ к ИС.

Для заблокированного сеанса должно осуществляться блокирование любых действий по доступу к информации и устройствам её отображения, кроме необходимых для разблокирования сеанса.

Блокирование сеанса доступа пользователя в ИС должно сохраняться до прохождения им повторной идентификации и аутентификации в соответствии с мерой ИАФ.1

Правила и процедуры блокирования сеансов доступа должны быть описаны в организационно-распорядительных документах по защите информации у заказчика.

| № | Интерфейс | Назначение | Тип интерфейса | Категории | Справка |
|---|-----------|------------|----------------|-----------|---------|
| 1. | /usr/bin/vlock | Интерфейс блокировки терминала. | Команда. | Ограничение доступа. | vlock(1) |
| 2. | /usr/bin/tmux<br>/usr/bin/screen | Интерфейс мультиплексора терминала. | Команды. | Ограничение доступа. | tmux(1)<br>screen(1) |
| 3. | /etc/tmux.conf<br>/etc/screenrc<br>/etc/bashrc.d/*.sh | Интерфейсы принудительного запуска vlock при достижении тайм-аута блокировки. | Конфигурационные файлы. | Ограничение доступа. | tmux(1)<br>screen(1)<br>bash(1) |
| 4. | /usr/bin/gpui-main | Позволяет централизованно задать и принудительно применить настройки для пользователей домена в Linux через механизм gpui. | Команда. | Ограничение доступа.<br><br>Доменные пользователи. | gpui(1)<br>[Руководство администратора, п. 3.6.2](https://www.basealt.ru/fileadmin/user_upload/manual/ALT_Domain_guide.pdf) |
| 5. | /etc/openssh/sshd_config | Позволяет настроить блокировку ssh-сеанса при помощи полей ClientAliveInterval и ClientAliceCountMax. | Конфигурационные файлы. | Ограничение доступа.<br><br>Сетевые ресурсы. | sshd_config(5) |

В ОС есть возможность использовать мультиплексор терминала <code>tmux</code> или <code>screen</code> с установлением времени блокировки после заданного периода бездействия.<br>
Редактирование политики запускается командой
```
gpui-main -p "smb://dc1.test.alt/SysVol/test.alt/Policies/{XXXXXXXXXXXX-XXXX-XXXX-XXXXXXXXXXXXXX}"
```
В данном случае <code>dc1</code> – имя ПК, <code>test.alt</code> – имя домена.

В <code>gpui</code> групповая политика лежит по пути <code>Компьютер/Административные шаблоны/Система ALT/Настройки MATE/Хранитель экрана/Время до блокировки паролем</code>

**УПД.11 Разрешение (запрет) действий пользователей, разрешенных до идентификации и аутентификации<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.2., стр. 37)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) в ИС должно обеспечиваться разрешение действий пользователя до прохождения им идентификации и аутентифицации в соответствии с перечнем таких действий, установленных оператором.

Правила и процедуры для определения действий пользователей, разрешенных до прохождения ими процедур идентификации и аутентификации должны быть описаны в организационно-распорядительных документах по защите информации у заказчика.

| № | Интерфейс | Назначение | Тип интерфейса | Категории | Справка |
|---|-----------|------------|----------------|-----------|---------|
| 1. | /etc/lightdm/lightdm.conf | Позволяет определить действия пользователей, разрешённые до прохождения идентификации и аутентификации в lightdm. | Конфигурационный файл. | Локальные пользователи.<br><br>Доменные пользователи. | [3.2.10. Разрешение (запрет) действий пользователей, разрешенных до идентификации и аутентификации](https://www.basealt.ru/fileadmin/user_upload/manual/LKNV.11100-01_99_03_Rukovodstvo_po_kompleksu_sredstv_zashchity.pdf) |
| 2. | /usr/bin/gpui-main | Позволяет централизованно задать и принудительно применить настройки для пользователей домена в Linux через механизм gpui. | Команда. | Доменные пользователи. | gpui(1)<br>[Руководство администратора, п. 3.6.2](https://www.basealt.ru/fileadmin/user_upload/manual/ALT_Domain_guide.pdf) |
| 3. | /usr/bin/login | Обеспечивает интерактивный сеанс работы в системе. | Команда. | Локальные пользователи. | login(1)<br>[3.6.5.3.6 Ограничения службы Login](https://www.basealt.ru/fileadmin/user_upload/manual/ALT_Domain_guide.pdf) |

При использовании <code>lightdm</code> по умолчанию до аутентификации пользователям доступны следующие действия: возможность выключить или перезагрузить компьютер, поменять раскладку клавиатуры, посмотреть список пользователей.

При конфигурировании <code>/etc/lightdm/lightdm.conf</code> возможна дополнительная настройка действий, доступных пользователям до прохождения идентификации и аутентификации.

При помощи <code>GPUI</code> возможно применение групповых политик для реализации меры. Сами политики хранятся в <code>GPUI</code> по пути <code>Компьютер/Административные шаблоны/Система ALT/Правила Polkit/Ограничения Login</code>.

Групповые полиитки применяют соответствующие правила <code>Polkitd</code> как ограничения службы <code>login</code>.

**УПД.12 Поддержка и сохранение атрибутов безопасности (меток безопасности), связанных с информацией в процессе ее хранения и обработки<br>(мера является не обязательной для всех классов защищённости)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.2., стр. 38)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) в ИС должны обеспечиваться обновление, назначение, изменение и сохранение атрибутов безопасности (или меток безопасности), установленных оператором, связанных с информацией в процессе её хранения и обработки.

Атрибуты безопасности (или метки безопасности) представляют собой свойства объектов или субъектов доступа, которые используются для контроля доступа субъектов к объектам доступа и управления информационными потоками.

Правила и процедуры поддержки и сохранения атрибутов безопасности должны быть описаны в организационно-распорядительных документах по защите информации у заказчика.

Для технической реализации этой меры в ОС (и, соответственно, в ИС в целом) должно быть реализовано мандатное управление доступом, которое в ALT не реализовано по умолчанию. В системах ALT мандатное разграничение можно реализовать при помощи <code>SELinux</code>.
