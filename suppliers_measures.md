**ИАФ.1 Идентификация и аутентификация пользователей, являющихся работниками оператора<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.1., стр. 16)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. Пользователи должны однозначно идентифицироваться и аутентифицироваться для всех видов доступа, кроме тех, которые определяются как действия, разрешённые до идентификации и авторизации (соответствующая мера: УПД.11);
2. Аутентификация пользователей должна осуществляться с использованием паролей, аппаратных средств, биометрических характеристик, иных средств или в случае многофакторной аутентификации — определённой комбинации указанных средств;
3. В ИС должна обеспечиваться возможность однозначного сопоставления идентификатора пользователя (один идентификатор — один, соответствующий ему пользователь) с запускаемыми от его имени процессами.

Доступ к различным ресурсам для сотрудников оператора осуществляется в соответствии с матрицей доступа. Матрицу доступа задаёт заказчик.

Правила и процедуры идентификации и аутентификации пользователей должны быть описаны в организационно-распорядительных документах по защите информации у заказчика.

| № | Интерфейс | Назначение | Тип интерфейса | Категории | Справка |
|---|-----------|------------|----------------|-----------|---------|
| 1. | /bin/login | Старт интерактивной сессии.<br>Запускается только в сессии без графического интерфейса. | Команда. | Локальные пользователи.<br><br>Сессия без графического интерфейса. | login(1) |
| 2. | /usr/bin/id<br>/usr/bin/groups | Отображает текущий, реальный или эффективный идентификатор и идентификатор группы, в которые входит пользователь. | Команды. | Локальные пользователи.<br><br>Сетевые ресурсы. | id(1)<br>groups(1) |
| 3. | /bin/su<br>/usr/bin/sudo | Смена пользователей и повышение привилегий. | Команды. | Локальные пользователи.<br><br>Механизмы повышения привилегий. | su(1)<br>sudo(8)<br>runas(1) |
| 4. | /etc/shadow<br>/etc/shadow-<br>/etc/tcb/[user]/shadow<br>/etc/gshadow<br>/etc/gshadow- | БД паролей и атрибутов субъектов доступа. В данном случае атрибутом аутентификационной информации являются пароли для учётных записей пользователей. | Конфигурационные файлы. | Локальные пользователи. | shadow(5) |
| 5. | getresuid()<br>getresgid()<br>getuid()<br>geteuid()<br>setuid()<br>setgid()<br>setegid()<br>setregid() | Получение или установка текущего реального или эффективного идентификатора пользователя или группы, в которой состоит пользователь. Обеспечение связывания пользователь-субъект. | Системные вызовы и библиотечные функции. | Локальные пользователи. | getresuid(2)<br>getresgid(2)<br>getuid(2)<br>geteuid(2)<br>setuid(2)<br>setgid(2)<br>setegid(2)<br>setregid(2) |
| 6. | /usr/sbin/passwd | Обеспечение проверки и манипуляций с аутентификационной информацией. | Команда. | Локальные пользователи. | passwd(1, 8) |
| 7. | /etc/pam.d/\*<br>/usr/lib64/security/pam\*.so | Реализация модулей управления типами и политиками аутентификации и файлы конфигурации этих модулей и политик. | Конфигурационные файлы и разделяемые библиотеки. | Локальные пользователи. | pam(5)<br>pam(8)<br>pam_unix(8)<br>pam_tcb(8) |
| 8. | /etc/sssd/sssd.conf<br>/etc/krb5.conf | Настройка подключения к AD/LDAP, Kerberos и GPO. Кэширование учётных данных, авторизация через GPO/LDAP/HBAC. | Конфигурационные файлы. | Доменные пользователи.<br><br>SSSD. | sssd(8)<br>kerberos(7) |
| 9. | /lib64/security/pam_sss.so<br>/lib64/security/pam_krb5.so<br>/lib64/security/pam_ldap.so | PAM-модули для аутентификации через AD/LDAP/Kerberos, интеграция с GPO. | Модули PAM. | Доменные пользователи.<br><br>SSSD. | pam_sss(8)<br>pam_krb5(5) |
| 10. | /var/lib/sss/db/cache_<домен>.ldb | Кэш авторизационных данных, GPO, тикетов Kerberos. | Внутренний кэш | Доменные пользователи.<br><br>SSSD. | sss_cache(8) |
| 11. | /etc/samba/smb.conf<br>/etc/nsswitch.conf<br>/etc/krb5.conf | Настройка Kerberos-аутентификации, сопоставления SID-UID, поддержка offline входа, GPO (через gpupdate). | Конфигурационные файлы. | Доменные пользователи.<br><br>Сетевые ресурсы.<br><br>Winbind. | smb.conf(5)<br>nsswitch.conf(5)<br>krb5.conf(5) |
| 12. | /lib64/security/pam_winbind.so<br>/usr/lib64/nss_winbind.so | PAM и NSS-интерфейсы, авторизация по SID через RPC и Kerberos/NTLM. | Модули PAM. | Доменные пользователи.<br><br>Сетевые ресурсы.<br><br>Winbind. | pam_winbind(8) |
| 13. | /var/lib/samba/\*.tdb | TDB-файлы с SID, UID/GID, SID-Map (winbindd_cache.tdb, idmap.tdb). | Внутренний кэш. | Доменные пользователи.<br><br>Сетевые ресурсы.<br><br>Winbind. | samba(7) |
| 14. | /usr/bin/gpupdate<br>/usr/sbin/gpoa<br>/lib64/security/pam_oddjob_gpupdate.so | Применение групповых политик доступа (GPO) при входе через Winbind/SSSD. | Команды.<br>Модули PAM. | Доменные пользователи.<br><br>Сетевые ресурсы.<br><br>GPO. | pam_oddjob_gpupdate(8) |
| 15. | /usr/share/lightdm/lightdm.conf.d/\*.conf<br>/etc/lightdm/lightdm.conf.d/\*.conf<br>/etc/lightdm/lightdm.conf | Настройка дисплейного менеджера LightDM. | Конфигурационные файлы. | Графическая среда (MATE). | lightdm(1) |
| 16. | /usr/sbin/control pam-pkcs11-profile<br>/usr/sbin/control pam-pkcs11-param-set<br>/usr/sbin/control pam-pkcs11-mapping | Выбор профиля железа, логики сопоставления пользователей, параметров поведения и сообщений. | Команды.<br>Контролы. | Аутентификация по смарт-картам (PKCS#11).<br><br>Двухфакторная аутентификация. | [Alt Wiki: Pkcs11-profiles](https://www.altlinux.org/Pkcs11-profiles) |
| 17. | /lib64/security/pam_pkcs11.so | PAM-модули для аутентификации по смарт-картам и токенам (PKCS#11, X.509). | Модули PAM. | Аутентификация по смарт-картам (PKCS#11).<br><br>Двухфакторная аутентификация. | pam_pkcs11(8) |
| 18. | /etc/security/pam_pkcs11<br>/etc/security/cacerts<br>/etc/security/crls<br>$HOME/.eid | Директория с конфигурацией pam_pkcs11, включая доверенные корневые сертификаты (CACerts), списки отозванных (CRL), пользовательские сертификаты. | Конфигурационные файлы. | Аутентификация по смарт-картам (PKCS#11).<br><br>Двухфакторная аутентификация. | pam_pkcs11(8)<br>[Alt Wiki: Pkcs11-profiles](https://www.altlinux.org/Pkcs11-profiles) |
| 19. | /usr/bin/pkcs11_inspect<br>/usr/bin/pklogin_finder | Анализ и проверка токенов, генерация соответствий для subject_mapping у pkcs11. | Команды. | Аутентификация по смарт-картам (PKCS#11).<br><br>Двухфакторная аутентификация. | pam_pkcs11(8) |
| 20. | /usr/sbin/control system-auth pkcs11 | Включение аутентификации по смарт-картам в PAM через pam_pkcs11. | Команда. | Аутентификация по смарт-картам (PKCS#11).<br><br>Двухфакторная аутентификация. | [Alt Wiki: двухфакторная аутентификация](https://www.altlinux.org/Двухфакторная_аутентификация) |
| 21. | /etc/security/pam_pkcs11/subject_mapping<br>/etc/security/pam_pkcs11/cn_mapping | Таблицы соответствия: какой сертификат соответствует какому пользователю. | Конфигурационные файлы. | Аутентификация по смарт-картам (PKCS#11).<br><br>Двухфакторная аутентификация. | [Alt Wiki: двухфакторная аутентификация](https://www.altlinux.org/Двухфакторная_аутентификация) |

**Краткое описание технической реализации меры ИАФ.1**

В операционной системе Альт 8 СП идентификация и аутентификация субъектов доступа реализуются с использованием механизмов локальной, доменной (на базе SSSD и Winbind), двухфакторной аутентификации а аутентификации при помощи смарт-карт.

***Общая последовательность действий при получении интерактивного сеанса***

Пользователь инициирует вход в систему через терминал или графический интерфейс.
* При инициализации входа в систему через терминал запускается программа <code>login</code>, либо соответствующая точка входа (<code>sshd</code>, <code>sudo</code>).
* При инициализации входа в систему через графический интерфейс (MATE) запускается <code>LightDM</code>.

Запускается PAM-стек, настроенный в соответствующем файле из <code>/etc/pam.d/\*</code>, в частности:
* <code>/etc/pam.d/system-auth</code> — основная системная политика;
* <code>/etc/pam.d/system-auth-sss</code>, <code>/etc/pam.d/system-auth-krb5</code>, <code>/etc/pam.d/system-auth-winbind</code> — доменные политики;
* <code>/etc/pam.d/sshd</code>, <code>/etc/pam.d/sudo</code> — политики для отдельных точек входа.

В зависимости от конфигурации, выполняются модули <code>pam_unix</code>, <code>pam_sss</code>, <code>pam_winbind</code>, <code>pam_pkcs11</code>, <code>pam_oath</code> и другие.
Вводимые пользователем данные (логин, пароль, токен и др.) передаются соответствующим модулям для сверки с БД пользователей, каталогом <code>LDAP</code>, токеном <code>PKCS#11</code> или системой <code>2FA</code>.
При успешной аутентификации происходит авторизация и предоставление интерактивного сеанса.

***Локальная идентификация и аутентификация***

Пользователь вводит имя и пароль через <code>login</code>, <code>su</code>, <code>sudo</code>, <code>sshd</code> или графический вход.
Активируется PAM-стек (<code>system-auth</code>, <code>sshd</code>, <code>sudo</code>), где основным модулем является <code>pam_unix.so</code>.
<code>pam_unix</code> вызывает функцию <code>password()</code> и сверяет введённый пароль с данными в <code>/etc/shadow</code>, <code>/etc/tcb/[user]/shadow</code>.
При успешной проверке пользователь получает сессию, которая связывается с <code>UID</code>, <code>GID</code> через системные вызовы <code>setuid()</code>, <code>getuid()</code>, <code>geteuid()</code> и т.д.
Идентификатор пользователя может быть просмотрен через <code>id</code>, <code>groups</code>, или использоваться в процессе через <code>getresuid()</code> и т.д.

***Доменная аутентификация через SSSD***

Пользователь вводит имя в формате <code>username@REALM</code> и пароль.<br>
PAM-стек использует модули <code>pam_sss.so</code>, <code>pam_krb5.so</code>, <code>pam_ldap.so</code>, указанные в <code>/etc/pam.d/system-auth-sss</code> и других соответствующих политиках.

Модуль <code>pam_sss</code> направляет запрос аутентификации в <code>sssd</code>, который:
* Получает тикет у Kerberos-сервера на основе данных из <code>/etc/krb5.conf</code>;
* Получает атрибуты пользователя из LDAP-каталога (например, AD) на основе настроек в <code>/etc/sssd/sssd.conf</code>;
* Кэширует результат в <code>/var/lib/sss/db/cache_<домен>.ldb</code>.
* При успешной проверке <code>pam_sss</code> разрешает вход.

Авторизация может быть дополнительно проверена через <code>GPO/HBAC</code> (<code>sssd-ad</code>, параметры файла <code>/etc/sssd/sssd.conf</code>: <code>ad_gpo_access_control</code>, <code>ad_gpo_map_*</code>).

***Доменная аутентификация через Winbind***

Пользователь вводит имя в формате <code>DOMAIN\username</code> или <code>username@domain</code> и пароль.<br>
<code>PAM</code> использует модуль <code>pam_winbind.so</code> и NSS-модуль <code>nss_winbind.so</code>, описанные в <code>/etc/pam.d/system-auth-winbind</code>.<br>

<code>Winbind</code> использует конфигурацию <code>/etc/samba/smb.conf</code>, <code>/etc/nsswitch.conf</code>, <code>/etc/krb5.conf</code>:
* Выполняется аутентификация через <code>Kerberos</code> (или <code>NTLM</code>, если включено);
* <code>SID-UID/GID</code> сопоставляются через <code>IDMAP</code>;
* Результаты кэшируются в <code>/var/lib/samba/\*.tdb</code>.

При наличии доступа <code>Winbind</code> возвращает положительный ответ PAM-модулю.<br>
Могут быть применены политики через <code>gpupdate</code>, <code>pam_oddjob_gpupdate.so</code>, поддерживается offline-вход.<br>

***Аутентификация по смарт-карте (PKCS#11)***

Пользователь вставляет смарт-карту в считыватель.<br>
При вызове <code>login</code> или <code>sshd</code>, PAM-стек использует модуль <code>pam_pkcs11.so</code>, активируемый через <code>control system-auth pkcs11</code>.<br>

Модуль проверяет:
* Наличие доверенных сертификатов в <code>/etc/security/cacerts</code>;
* Отсутствие отзыва (<code>CRL</code>) через <code>/etc/security/crls</code>;
* Сопоставление пользователя через <code>subject_mapping</code> или <code>cn_mapping</code> в <code>/etc/security/pam_pkcs11</code>.

Для настройки используются:
* <code>control pam-pkcs11-profile</code> — выбор аппаратного профиля;
* <code>control pam-pkcs11-param-set</code> — поведение (тихий режим, отладка);
* <code>control pam-pkcs11-mapping</code> — логика сопоставления сертификатов и пользователей.

Проверка может быть протестирована через <code>pklogin_finder</code> и <code>pkcs11_inspect</code>.<br>
При успешной проверке создаётся пользовательский сеанс.

***Двухфакторная аутентификация (2FA)***

В конфигурацию PAM (<code>/etc/pam.d/system-auth</code>, <code>sshd</code>) добавляется модуль <code>pam_oath.so</code> или <code>pam_google_authenticator.so</code>.<br>

Пользователь вводит сначала логин/пароль, затем одноразовый пароль (<code>OTP/TOTP</code>):
* <code>OTP</code> сравнивается с ключом в <code>/etc/security/pam_oath.conf</code>;
* <code>TOTP</code> — через файл <code>~/.google_authenticator</code>, созданный при инициализации.

Ввод проверяется на соответствие текущему времени или счётчику.<br>
Вход происходит только при успешной верификации всех факторов.

***Хранение и защита данных***

Все пароли хранятся в хешированном виде (<code>/etc/shadow</code>, <code>tcb</code>).<br>
Сертификаты — в <code>/etc/security/cacerts</code>, <code>CRL</code> — в <code>/etc/security/crls</code>.<br>
Конфигурации пользователей и соответствий — в <code>pam_pkcs11/subject_mapping</code>, <code>cn_mapping</code>.<br>
Ввод данных осуществляется без обратной связи.<br>
Все каналы передачи защищены (<code>TLS</code>, <code>SSH</code>).<br>
Перед вводом данных на физическом терминале выполняется принудительный сброс сессии для обеспечения доверенного маршрута.

**ИАФ.2 Идентификация и аутентификация устройств, в том числе стационарных, мобильных и портативных<br>(мера обязательна для К1 и К2)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.1., стр. 18)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. Идентификация устройств в ИС должна обеспечиваться по логическим именам (имя устройства или его ID), логическим (например, IP) или физическим (например, MAC) адресам устройства или по комбинации имени, логического и (или) физического адресов устройства;
2. Аутентификация устройств должна обеспечиваться с использованием соответствующих протоколов аутентификации или с применением в соответствии с законодательством РФ криптографических методов защиты информации.

Правила и процедуры идентификации и аутентификации устройств должны быть описаны в организационно-распорядительных документах по защите информации у заказчика.

| № | Интерфейс | Назначение | Тип интерфейса | Категории | Справка |
|---|-----------|------------|----------------|-----------|---------|
| 1. | /bin/hostname<br>/usr/bin/hostnamectl | Вывод или установка имени системы. | Команды. | Идентификаторы. | hostname(1)<br>hostnamectl(1) |
| 2. | /proc/sys/kernel/hostname | Содержит идентификацию системы в ядре ОС. | Команда. | Идентификаторы. | proc(5) |
| 3. | /etc/hosts | Содержит БД, связывающую логическое имя системы с логическим адресом узла. | Конфигурационный файл. | Идентификаторы.<br><br>Сетевые ресурсы. | hosts(5) |
| 4. | /etc/hostname<br>/etc/sysconfig/network | Содержит логическое имя узла (с доменным именем). | Конфигурационные файлы. | Идентификаторы.<br><br>Сетевые ресурсы. | hostname(1)<br>hostname(7)<br>info hostname<br>[Alt Wiki: etcnet](https://www.altlinux.org/Etcnet) |
| 5. | /sys/devices/\*<br>/sys/block/\*<br>/sys/bus/\*<br>/sys/class/\*<br>/sys/dev/\* | Содержит идентификаторы всех устройств, распознанных ОС. | Файлы структур данных ядра ОС. | Идентификаторы. | sysfs(5) |
| 6. | /etc/machine-id<br>/var/lib/dbus/machine-id | Содержит уникальный логический идентификатор установленной системы. Используется в том числе в интересах обработки и идентификации сообщения на шине D-BUS при взаимодействии между процессами и устройствами. | Конфигурационные файлы. | Идентификаторы. | dbus-uuidgen(1) |
| 7. | /sbin/systemd-machine-id-setup | Устанавливает уникальный логический идентификатор системы. | Команда. | Идентификаторы. | systemd-machine-d-setup(8) |
| 8. | /bin/uname | Сообщает информацию о ПК и ОС. | Команда. | Идентификаторы. | uname(1) |
| 9. | uname()<br>sethostname()<br>gethostname() | Сообщает имя ядра, системы, или устанавливает имя системы. | Системные вызовы и библиотечные функции. | Идентификаторы. | uname(2)<br>sethostname(2)<br>gethostname(2) |
| 10. | /etc/udev/udev.conf<br>/etc/udev/rules.d/\*<br>/usr/lib/udev/\* | Обработчик событий для устройств, работающий в интересах пользовательского пространства. | Конфигурационные файлы. | Идентификаторы.<br><br>USB-устройства. | udev(7)<br>udev.conf(5)<br>systemd-udevd(8) |
| 11. | /sbin/ip link<br>/sbin/ip addr | Получение MAC- и IP-адресов сетевых интерфейсов, настройка сетевых параметров устройства. | Команда. | Идентификаторы.<br><br>Сетевые ресурсы. | ip(8) |
| 12. | /sys/class/net/\*/address | Доступ к MAC-адресу сетевого интерфейса через sysfs. | Файл структуры данных ядра ОС. | Идентификаторы.<br><br>Сетевые ресурсы. | sysfs(5) |
| 13. | /sbin/udevadm info<br>/sbin/udevadm monitor | Просмотр атрибутов устройства, контроль событий и диагностика udev. | Команда. | Идентификаторы.<br><br>USB-устройства. | udevadm(8) |
| 14. | /sbin/blkid<br>/bin/lsblk -o UUID,SERIAL | Получение UUID, серийных номеров и меток устройств хранения. | Команды. | Идентификаторы. | blkid(8)<br>lsblk(8) |
| 15. | /etc/fstab | Привязка устройств по UUID/метке для управления монтированием. | Конфигурационный файл. | Идентификаторы. | fstab(5) |
| 16. | /etc/usbguard/rules.conf | Правила разрешения/запрета USB-устройств по серийному номеру, VID/PID, хэшу. | Конфигурационный файл. | Идентификаторы.<br><br>USB-устройства. | [Alt Wiki: USBGuard](https://www.altlinux.org/USBGuard) |
| 17. | /usr/bin/usbguard<br>/usr/sbin/usbguard-daemon | Демон и утилита для управления политиками USB-доступа. | Команда и служба. | Идентификаторы.<br><br>USB-устройства. | [Alt Wiki: USBGuard](https://www.altlinux.org/USBGuard) |
| 18. | /sbin/udevadm<br>/lib/udev/\* | Подсистема обработки событий устройств. Реагирует на появление новых устройств. | Команда и системные сценарии. | Идентификаторы.<br><br>USB-устройства. | udevadm(8) |

**Краткое описание технической реализации меры ИАФ.2**

Идентификация и аутентификация устройств, включая стационарные, мобильные и портативные, осуществляется на основе логических имён, логических (сетевых) адресов, физических идентификаторов и уникальных системных параметров, доступных в файловой системе, ядре и подсистемах Linux. Все устройства, распознанные ОС, однозначно идентифицируются как объекты доступа.

***Идентификация копии установленной ОС***

1. <b>При установке ОС оператор вручную задаёт логическое имя узла (<code>FQDN</code>) в соответствии с документацией ИС. Это имя записывается в файлы:</b>
* <code>/etc/hostname</code> — логическое имя хоста;
* <code>/etc/hosts</code> — привязка имени к IP-адресу.
2. <b>При загрузке ОС имя хоста из /etc/hostname подставляется в ядро и доступно по пути:</b>
* <code>/proc/sys/kernel/hostname</code>;
* также оно доступно через системные вызовы <code>gethostname()</code>, <code>sethostname()</code>.
3. <b>Дополнительно при установке формируется уникальный идентификатор ОС:</b>
* <code>/etc/machine-id</code> или <code>/var/lib/dbus/machine-id</code>;
* генерируется службой <code>systemd-machine-id-setup</code>;
* используется службами, D-Bus и другими компонентами для внутренней идентификации системы.

***Идентификаторы устройств и их регистрация***

1. <b>Ядро ОС отслеживает события от устройств (например, подключение USB, сетевой карты и т.д.) через системные события (прерывания), обрабатываемые подсистемой <code>udev</code>.</b>
2. <b>Подсистема <code>udev</code> (пользовательское пространство) выполняет:</b>
* регистрацию устройства;
* назначение логического имени в <code>/dev</code> (например, <code>/dev/sda</code>, <code>/dev/ttyUSB0</code>);
* назначение логического имени через правила в <code>/etc/udev/rules.d/\*.rules</code>;
* загрузку модулей ядра и установку прошивки при необходимости;
* настройку прав доступа к устройству (разграничение доступа).
3. <b>Идентификаторы устройств:</b>
* <code>/sys/devices/\*</code>, <code>/sys/class/\*</code>, <code>/sys/block/\*</code> — полные и уникальные пути в <code>sysfs</code>;
* <code>/dev/\*</code> — символьные и блочные файлы устройств;
* <code>udevadm info</code> позволяет получить уникальные атрибуты: <code>ID_SERIAL</code>, <code>ID_VENDOR</code>, <code>ID_MODEL</code> и др.

***Идентификация по физическим и сетевым параметрам***

1. <b>MAC-адрес сетевого интерфейса (например, <code>eth0</code>) считывается:</b>
* через <code>ip link</code>, <code>cat /sys/class/net/eth0/address</code>.
2. IP-адрес может быть привязан к имени хоста в <code>/etc/hosts</code>, а также через внешние механизмы (<code>DHCP</code>, <code>DNS</code>).
3. <code>UUID</code> и серийные номера устройств хранения (дисков) доступны через:
* <code>lsblk -o UUID,SERIAL</code>, <code>blkid</code>;
* используются в <code>/etc/fstab</code> для безопасного монтирования.

***Логические и комбинированные идентификаторы устройств***

Внутри системы устройства могут идентифицироваться через:
* логическое имя устройства в <code>/dev</code> (например, <code>/dev/sda1</code>);
* уникальный путь в <code>sysfs</code> (например, <code>/sys/devices/pci0000:00/0000:00:14.0/usb1</code>);
* атрибуты в <code>sysfs</code>: <code>product</code>, <code>vendor</code>, <code>serial</code>, <code>modalias</code> и др.;
* правила <code>udev</code> с логикой сопоставления и создания символьных имён (<code>SYMLINK+=</code>);
* логические имена путей в файловой системе (<code>/mnt/usb1</code>, <code>/media/token</code> и др.).

***Контроль и фильтрация устройств***

1. <b>Контроль USB-устройств может реализовываться через <code>usbguard</code>:</b>
* список разрешённых устройств: <code>/etc/usbguard/rules.conf</code>;
* демон <code>usbguard-daemon</code> отслеживает подключение и применяет правила.
2. <b>Контроль <code>MAC/IP</code> устройств:</b>
* через <code>iptables</code>, <code>nftables</code>, <code>firewalld</code> можно ограничить доступ устройств по <code>IP</code> или <code>MAC</code>;
* через <code>Match Address</code> в <code>/etc/openssh/sshd_config</code> можно разрешать доступ только с определённых устройств.

**ИАФ.3 Управление идентификаторами, в том числе создание, присвоение, уничтожение идентификаторов<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.1., стр. 19)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. Формирование идентификатора, который однозначно идентифицирует пользователя или устройство;
2. Присвоение идентификатора пользователю или устройству;
3. Предотвращение повторного использования идентификатора идентификатора или устройства в течение установленного оператором периода времени;
4. Блокирование идентификатора пользователя после установленного оператором времени неиспользования.

Правила и процедуры управления идентификаторами должны быть описаны в организационно-распорядительных документах по защите информации у заказчика.

| № | Интерфейс | Назначение | Тип интерфейса | Категории | Справка |
|---|-----------|------------|----------------|-----------|---------|
| 1. | /usr/bin/chage | Устанавливает блокировку учётной записи пользователя, после определённого времени неактивности. | Команда. | Локальные пользователи. | chage(1) |
| 2. | /etc/passwd<br>/etc/passwd-<br>/etc/group<br>/etc/group- | Содержат атрибуты учётных записей. | Конфигурационные файлы. | Локальные пользователи. | passwd(5)<br>group(5) |
| 3. | /usr/sbin/passwd | Изменяет пароль и атрибуты учётной записи. | Команда. | Локальные пользователи. | passwd(1, 8) |
| 4. | /usr/bin/chfn | Изменяет информацию о субъекте доступа. | Команда. | Локальные пользователи. | chfn(1) |
| 5. | /usr/sbin/useradd<br>/usr/sbin/usermod | Добавляет или модифицирует пользователя. | Команды. | Локальные пользователи. | useradd(8)<br>usermod(8) |
| 6. | /etc/login.defs | Задание диапазона UID и запрета на повторное использование идентификатора при помощи UID_MAX, UID_MIN, USERGROUPS_ENAB, UID_RESERVE. | Конфигурационный файл. | Локальные пользователи. | login.defs(5) |

**Краткое описание технической реализации меры ИАФ.3**

Реализация управления идентификаторами, включая их формирование, присвоение, блокировку, ограничение срока действия и предотвращение повторного использования, обеспечивается на уровне системных команд, конфигурационных файлов и логики аутентификации <code>PAM</code>.

***Формирование и присвоение идентификаторов***

Формирование уникального идентификатора осуществляется при создании учётной записи:
* через команду <code>/usr/sbin/adduser</code> или <code>/usr/sbin/useradd</code>, которая формирует запись в <code>/etc/passwd</code>, <code>/etc/shadow</code>, <code>/etc/group</code> и, при использовании <code>TCB</code>, в <code>/etc/tcb/[user]/shadow</code>;
* параметры <code>UID</code> и <code>GID</code> назначаются автоматически или задаются явно;
* для управления учётными записями в домене используются команды <code>/usr/bin/samba-tool user</code> и <code>/usr/bin/samba-tool group</code> с подкомандами.

***Модификация идентификаторов и атрибутов***

После создания идентификатор может быть изменён или дополнен через:
* команду <code>usermod</code> — изменение логина, <code>UID</code>, сроков действия;
* команду <code>passwd</code> — смена пароля и даты его смены;
* команду <code>chfn</code> — изменение поля <code>GECOS</code> (описание пользователя);
* команду <code>chage</code> — установка сроков действия, даты истечения пароля, дней до блокировки;
* при отсутствии явных сроков в атрибутах используются значения из <code>/etc/login.defs</code> — параметры <code>PASS_MAX_DAYS</code>, <code>PASS_MIN_DAYS</code>, <code>INACTIVE</code>, <code>UID_MIN</code>, <code>UID_MAX</code>, <code>UID_RESERVE</code>, и др.

***Блокировка и срок действия идентификаторов***

Параметры, определяющие время действия идентификатора:
* <code>chage -E <YYYY-MM-DD></code> — устанавливает дату блокировки учётной записи;
* <code>chage -I N</code> — блокирует учётную запись после <code>N</code> дней неиспользования;
* <code>passwd -l</code> — вручную блокирует пароль пользователя (и вход);
* <code>/etc/shadow</code> — поле с датой истечения срока действия пароля.
При попытке входа в систему <code>PAM</code> проверяет сроки действия через модули <code>pam_unix</code> или <code>pam_sss</code>, и, если они истекли или учётная запись заблокирована, вход отклоняется.

***Предотвращение повторного использования идентификатора***

По умолчанию ОС не ограничивает повторное использование логина или <code>UID</code>. Для выполнения этого требования применяются организационные меры:
1. Поддержка архива удалённых логинов/<code>UID</code>:
* ведение файла <code>/etc/security/uid_archive</code> со списком логинов, которые нельзя использовать повторно;
2. Обёртка над <code>useradd</code>, проверяющая наличие логина в архиве перед созданием;
3. Конфигурация <code>/etc/login.defs</code> с зарезервированными <code>UID</code> (через <code>UID_MIN</code>, <code>UID_MAX</code>, <code>UID_RESERVE</code>) и пользовательскими группами (<code>USERGROUPS_ENAB</code>);
4. При использовании <code>FreeIPA</code> или <code>LDAP</code> возможна централизованная проверка и запрет переиспользования логинов.

**ИАФ.4 Управление средствами аутентификации, в том числе хранение, выдача, инициализация, блокирование средств аутентификации и принятие мер в случае утраты и (или) компрометации средств аутентификации<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.1., стр. 20)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. Возможность хранения, выдачи, инициализации, блокирования средств аутентификации;
2. Возможность изменения аутентификационной информации (средств аутентификации), заданных их производителями или используемых при внедрении системы защиты информации ИС;
3. Генерация начальной аутентификационной информации;
4. Возможность установления характеристик пароля (при использовании в ИС механизмов аутентификации на основе пароля):
* задане минимальной сложности пароля с определяемыми оператором требованиям к регистру, количеству символов, сочетанию букв верхнего и нижнего регистра, цифр и специальных символов;
* задание минимального количества изменённых символов при создании новых паролей;
* задание максимального времени действия пароля;
* задание минимального времени действия пароля;
* запрет на использование пользователями определённого оператором числа последних использованных паролей при создании новых паролей;
5. Возможность блокирования и замены утерянных, скомпрометированных или повреждённых средств аутентификации;
6. Назначение необходимых характеристик средств аутентификации (в т.ч. паролей);
7. Возможность обновления аутентификационной информации (замена средств аутентификации) с периодичностью, установленной оператором;
8. Защита аутентификационной информации от неправомерного доступа к ней и модифицирования.

Правила и процедуры управления средствами аутентификации должны быть описаны в организационно-распорядительных документах по защите информации у заказчика.

| № | Интерфейс | Назначение | Тип интерфейса | Категории | Справка |
|---|-----------|------------|----------------|-----------|---------|
| 1. | /etc/pam.d/system-auth-local-only<br>/etc/pam.d/system-auth-common | Устанавливает необходимость применения парольной политики. | Конфигурационные файлы. | Локальные пользователи. | pam(8) |
| 2. | /usr/lib64/security/* | Реализация политик аутентификации. | Разделяемые библиотеки | Локальные пользователи. | pam(8)<br>pam_u2f(8) |
| 3. | /etc/passwdqc.conf<br>/etc/security/pwquality.conf | Устанавливает строгость парольных политик. | Конфигурационные файлы | Локальные пользователи. | passwdqc.conf(5)<br>[Настройка парольных ограничений](https://docs.altlinux.org/ru-RU/alt-server/10.2/html/alt-server/passwdqc.html)<br>pwquality.conf(5) |
| 4. | /usr/bin/samba-tool domain passwordsettings pso | Позволяет применить парольную политику к пользователям или группам пользователей. | Команда. |  | samba-tool(8) |
| 5. | /usr/bin/passwd | Установка/Изменение пароля. | Команда. | Локальные пользователи. | passwd(1, 8) |
| 6. | /usr/sbin/useradd<br>/usr/sbin/usermod | Создание пользователя, генерация начального пароля, блокировка, сброс и изменение параметров учётной записи пользователя. | Команды. | Локальные пользователи. | useradd(8)<br>usermod(8) |
| 7. | /usr/bin/chage | Установка сроков действия пароля, принудительная смена. | Команда. | Локальные пользователи. | chage(1) |
| 8. | /etc/login.defs | Значения по умолчанию для сроков действия и блокировки паролей. | Конфигурационный файл. | Локальные пользователи. | login.defs(5) |
| 9. | /etc/shadow<br>/etc/shadow-<br>/etc/tcb/[user]/shadow<br>/etc/gshadow<br>/etc/gshadow- | Защищённые хранилища хэшей паролей. | Системные файлы. | Локальные пользователи. | shadow(5) |
| 10. | /usr/lib64/security/pam_pwhistory.so | Позволяет настроить запрет повторного использования старых паролей. | Модуль PAM. | Локальные пользователи. | pam_pwhistory(8) |
| 11. | /etc/security/pwquality.conf | Позволяет настроить сложность пароля для локальных УЗ. | Конфигурационный файл | Локальные пользователи. | pwquality.conf(5) |
| 12. | /usr/bin/samba-tool domain passwordsettings set | Позволяет настроить сложность пароля для доменных УЗ. | Команда. | Доменные пользователи | samba-tool(8) |

**ИАФ.5 Защита обратной связи при вводе аутентификационной информации<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.1., стр. 22)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. Защита обратной связи в процессе аутентификации обеспечивается исключением отображения для пользователя действительного значения аутентификационной информации или количества вводимых пользователем символов аутентификационной информации. Вводимые символы пароля могут отображаться в виде условных знаков, например, знаком звёздочки "*", точки "·" и т.д.

Обычно защита обратной связи в процессе аутентификации обеспечивается в любой системе по умолчанию. 

**ИАФ.6 Идентификация и аутентификация пользователей, не являющихся работниками оператора (внешних пользователей)<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.1., стр. 23)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. Пользователи должны однозначно идентифицироваться и аутентифицироваться для всех видов доступа, кроме тех, которые определяются как действия, разрешённые до идентификации и авторизации (соответствующая мера: УПД.11);

Правила и процедуры идентификации и аутентификации должны быть описаны в организационно-распорядительных документах по защите информации у заказчика.

Мера аналогична мере ИАФ.1, за исключением того, что к внешним пользователям относят всех пользователей ИС, не указанных в ИАФ.1 в качестве внутренних пользователей.<br>
Пример внутренних пользователей: сотрудники оператора; лица, привлекаемые на договорной основе (ремонт, обслуживание ИС).<br>
Пример внешний пользователей: граждание, получаемые доступ к ИС на законных основаниях.<br>
Если в системе предусмотрена идентификация и аутентификация внешних пользователей с целью получения каких-либо государственных услуг, то идентификация и аутентификация должна происходить в соответствии с [постановлением Правительства РФ № 977 от 28.11.2011](https://www.consultant.ru/document/cons_doc_LAW_122455/).

Интерфейсы аналогичны тем, что указаны в мере ИАФ.1.

**ИАФ.7 Идентификация и аутентификация объектов файловой системы, запускаемых и исполняемых модулей, объектов систем управления базами данных, объектов, создаваемых прикладным и специальным программным обеспечением, иных объектов доступа<br>(мера является не обязательной для всех классов защищённости)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.1., стр. 24)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. В ИС должна осуществляться идентификация и атуентификация объектов файловой системы, запускаемых и исполняемых модулей, объектов систем управления базами данных, объектов, создаваемых прикладным и специальным программным обеспечением, иных объектов доступа.

Реализация меры становится обязательной, когда у заказчика она появляется в итоговом списке мер безопасности информации.

**УПД.1 Управление (заведение, активация, блокирование и уничтожение) учетными записями пользователей, в том числе внешних пользователей<br>(мера обязательна для К1, К2 и К3)**

***Требования для реализации меры:***

В соответствии с [Методическим документом ФСТЭК "Меры защиты информации в государственных информационных системах" от 11.02.2014 (п. 3.2., стр. 25)](https://fstec.ru/dokumenty/vse-dokumenty/spetsialnye-normativnye-dokumenty/metodicheskij-dokument-ot-11-fevralya-2014-g) для данной меры определяются следующие технические требования:
1. Определение типа учётной записи (внутреннего или внешнего пользователя, системная или приложения и т.д.);
2. Возможность определения учётных записей в группы;
3. Верификация пользователя при заведении учётной записи пользователя;
4. Возможность заведения, активации, блокирования и уничтожения учётных записей пользователей;
5. Оповещение администратора, осуществляющего управление учётными записями пользователей, об изменении сведений о пользователях, их ролях, обязанностях, полномочиях, ограничениях;
6. Возможность уничтожения временной учётных записей пользователей, предоставленных для однократного выполнения задач в ИС;
7. Возможность предоставления пользователям прав доступа к объектам доступа ИС, основываясь на задачах, решаемых пользователями в ИС и взаимодействующими с ней ИС.

Правила и процедуры управления учётными записями пользователей должны быть описаны в организационно-распорядительных документах по защите информации у заказчика.

Мера аналогична мере ИАФ.3.

В ОС Альт 8 СП управление учётными записями и группами пользователей может происходить централизовано для домена на контроллере домена при помощи <code>/usr/bin/samba-tool user<code> и <code>/usr/bin/samba-tool group</code>.
